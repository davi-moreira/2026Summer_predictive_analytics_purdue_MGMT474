<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.25">

  <meta name="author" content="Professor: Davi Moreira">
  <title>MGMT 47400: Predictive Analytics (Summer 2026 - 4-Week Intensive) –  MGMT 47400: Predictive Analytics </title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-96a67a1340eb436771fd03060be7db16.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title"><span style="font-size: 100%;"> MGMT 47400: Predictive Analytics </span></h1>
  <p class="subtitle"><span style="font-size: 150%;"> Deep Learning </span></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Professor: Davi Moreira 
</div>
</div>
</div>

</section>
<section id="overview" class="slide level2 center">
<h2>Overview</h2>
<div class="columns">
<div class="column" style="text-align: center; justify-content: center; align-items: center;">
<ul>
<li>Deep Learning</li>
<li>PyTorch vs.&nbsp;TensorFlow</li>
<li>PyTorch</li>
<li>Neural Networks</li>
<li>Single Layer Neural Network</li>
<li>Fitting Neural Networks</li>
</ul>
</div><div class="column" style="text-align: center; justify-content: center; align-items: center;">
<ul>
<li>Convolutional Neural Network — CNN</li>
<li>Document Classification</li>
<li>Recurrent Neural Networks - RNN</li>
<li>RNN for Document Classification</li>
<li>RNN for Time Series Forecasting</li>
<li>When to Use Deep Learning</li>
</ul>
</div></div>
<p><br></p>

<aside><div>
<p><em>This lecture content is inspired by and replicates the material from <a href="https://www.statlearning.com/">An Introduction to Statistical Learning</a>.</em></p>
</div></aside></section>
<section>
<section id="deep-learning" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Deep Learning</h1>

</section>
<section id="deep-learning-1" class="slide level2 center">
<h2>Deep Learning</h2>
<div style="font-size: 70%;">
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><strong>Early Rise (1980s)</strong>
<ul>
<li>Neural networks first gained popularity.<br>
</li>
<li>High levels of excitement, with dedicated conferences (e.g., NeurIPS, Snowbird).</li>
</ul></li>
<li><strong>1990s Shift</strong>
<ul>
<li>Emergence of other methods (SVMs, Random Forests, Boosting).<br>
</li>
<li>Neural networks receded into the background.</li>
</ul></li>
<li><strong>Resurgence (2010)</strong>
<ul>
<li>Rebranded and refined under the banner of <em>Deep Learning</em>.<br>
</li>
<li>By the 2020s, became extremely successful and widely adopted.</li>
</ul></li>
<li><strong>Key Drivers of Success</strong>
<ul>
<li>Rapid increases in computing power (GPUs, parallel computing).<br>
</li>
<li>Availability of large-scale datasets.<br>
</li>
<li>User-friendly deep learning libraries (e.g., TensorFlow, PyTorch).</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li><p>Much of the credit goes to three pioneers and their students:</p>
<ul>
<li><strong>Yann LeCun</strong>, <strong>Geoffrey Hinton</strong>, and <strong>Yoshua Bengio</strong>,<br>
who received the 2019 ACM Turing Award for their work in Neural Networks.</li>
</ul></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/10_1_1-1.png" class="quarto-figure quarto-figure-center" style="width:65.0%"></p>
</figure>
</div>
</div>
</div>
</div></div>
</div>
</section>
<section id="ai-visionaries-interviews" class="slide level2 center">
<h2>AI Visionaries: Interviews</h2>
<p><br></p>
<div style="font-size: 80%;">
<div class="columns">
<div class="column" style="width:33%;">
<div style="text-align: center;">
<iframe width="100%" height="300" src="https://www.youtube.com/embed/Ah6nR8YAYF4" title="Yann LeCun: How to Build a Brain" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
<p>
<a href="https://www.youtube.com/watch?v=Ah6nR8YAYF4" target="_blank"> <strong>Yann LeCun</strong><br>The Future of AI<br>Dec 16, 2023 </a>
</p>
</div>
</div><div class="column" style="width:33%;">
<div style="text-align: center;">
<iframe width="100%" height="300" src="https://www.youtube.com/embed/qrvK_KuIeJk" title="Geoffrey Hinton: 60 Minutes Interview" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
<p>
<a href="https://www.youtube.com/watch?v=qrvK_KuIeJk" target="_blank"> <strong>Geoffrey Hinton</strong><br>60 Minutes Interview<br>Oct 9, 2023 </a>
</p>
</div>
</div><div class="column" style="width:33%;">
<div style="text-align: center;">
<iframe width="100%" height="300" src="https://www.youtube.com/embed/5LgDUqCbBwo" title="Yoshua Bengio: Human-Level AI" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
<p>
<a href="https://www.youtube.com/watch?v=5LgDUqCbBwo" target="_blank"> <strong>Yoshua Bengio</strong><br>Path to Human-Level AI<br>Apr 24, 2024 </a>
</p>
</div>
</div></div>
</div>
</section></section>
<section>
<section id="pytorch-vs.-tensorflow" class="title-slide slide level1 center">
<h1>PyTorch vs.&nbsp;TensorFlow</h1>

<img data-src="figs/pytorch_vs_tensorflow.png" class="quarto-figure quarto-figure-center r-stretch" style="width:85.0%"></section>
<section id="what-are-deep-learning-frameworks" class="slide level2 center">
<h2>What Are Deep Learning Frameworks?</h2>
<ul>
<li class="fragment">Deep learning frameworks reduce boilerplate code, handle tensor operations efficiently, and make it easier to prototype and iterate on new architectures.</li>
<li class="fragment">Software libraries designed to streamline the creation, training, and deployment of neural networks.<br>
</li>
<li class="fragment">Provide <strong>pre-built functions</strong>, <strong>automatic differentiation</strong>, and <strong>GPU/TPU</strong> support.<br>
</li>
<li class="fragment"><strong>Necessity</strong>: They allow researchers and developers to focus on <strong>model design</strong> rather than low-level implementation details.</li>
</ul>
</section>
<section id="pytorch-and-tensor-flow" class="slide level2 center">
<h2>PyTorch and Tensor Flow</h2>
<div style="font-size: 65%;">
<div class="columns">
<div class="column" style="justify-content: center; align-items: center;">
<h3 id="what-is-pytorch">What is PyTorch?</h3>
<ul>
<li class="fragment"><p>Developed primarily by <strong>Facebook (Meta)</strong> and released on September 2016.</p></li>
<li class="fragment"><p>Emphasizes a <strong>dynamic computation graph</strong> (eager execution).</p></li>
<li class="fragment"><p>Highly <strong>“Pythonic”</strong>: feels natural for Python developers.</p></li>
<li class="fragment"><p>Strong community presence in <strong>academia</strong> and research.</p></li>
</ul>
<div class="fragment">
<h3 id="why-is-pytorch-necessary">Why is PyTorch Necessary?</h3>
<ul>
<li class="fragment"><strong>Ease of Use &amp; Debugging</strong>
<ul>
<li class="fragment">Evaluate expressions immediately without building a separate graph.<br>
</li>
<li class="fragment">More intuitive for experimenting with complex, innovative models.</li>
</ul></li>
<li class="fragment"><strong>Research Focus</strong>
<ul>
<li class="fragment">Quickly prototype new ideas and iterate.</li>
</ul></li>
<li class="fragment"><strong>Active Ecosystem</strong>
<ul>
<li class="fragment">Libraries like <strong>torchvision</strong>, <strong>torchaudio</strong>, and others for specialized tasks.</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<h3 id="how-to-begin">How to begin</h3>
<ul>
<li class="fragment"><a href="https://pytorch.org/tutorials/beginner/basics/intro.html" target="_blank">https://pytorch.org/tutorials/beginner/basics/intro.html</a>.</li>
<li class="fragment">There is also a YouTube Series (<a href="https://www.youtube.com/playlist?list=PL_lsbAsL_o2CTlGHgMxNrKhzP97BaG9ZN" target="_blank">PyTorch Beginner Series</a>) also here (<a href="https://pytorch.org/tutorials/beginner/introyt/introyt1_tutorial.html" target="_blank">Introduction to PyTorch</a>)</li>
</ul>
</div>
</div><div class="column" style="justify-content: center; align-items: center;">
<div class="fragment">
<h3 id="what-is-tensorflow">What is TensorFlow?</h3>
<ul>
<li class="fragment">Developed primarily by <strong>Google</strong> and released in November 2015.</li>
<li class="fragment">Historically used a <strong>static graph</strong> approach (with an “eager mode” added later).</li>
<li class="fragment">Comes with <strong>extensive tools</strong> for deployment (mobile, web, and production).</li>
<li class="fragment">Large ecosystem with well-integrated components (e.g., <strong>TensorBoard</strong>, <strong>TFX</strong>, <strong>TensorFlow Lite</strong>).</li>
</ul>
</div>
<div class="fragment">
<h3 id="why-is-tensorflow-necessary">Why is TensorFlow Necessary?</h3>
<ul>
<li class="fragment"><strong>Production-Ready</strong>
<ul>
<li class="fragment">Strong support for model serving at scale in enterprise environments.</li>
</ul></li>
<li class="fragment"><strong>Comprehensive Ecosystem</strong>
<ul>
<li class="fragment">Visualization (TensorBoard), data processing (TFX), and model deployment pipelines.<br>
</li>
</ul></li>
<li class="fragment"><strong>Cross-Platform &amp; Hardware Support</strong>
<ul>
<li class="fragment">Easily deploy models to cloud infrastructures, mobile devices, and specialized hardware (TPUs).</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<h3 id="how-to-begin-1">How to begin</h3>
<ul>
<li class="fragment"><a href="https://www.tensorflow.org/tutorials" target="_blank">https://www.tensorflow.org/tutorials</a>. There is also a <a href="https://www.tensorflow.org/" target="_blank">Quick Start!</a></li>
</ul>
</div>
</div></div>
</div>
</section>
<section id="key-differences" class="slide level2 center">
<h2>Key Differences</h2>
<table class="caption-top">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Aspect</th>
<th style="text-align: left;"><strong>PyTorch</strong></th>
<th style="text-align: left;"><strong>TensorFlow</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Computation Graph</strong></td>
<td style="text-align: left;">Dynamic graph (eager execution by default).</td>
<td style="text-align: left;">Historically static graph with a build-and-execute phase (now supports eager execution).</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Debugging &amp; Development Style</strong></td>
<td style="text-align: left;">More straightforward for Python developers, immediate error feedback.</td>
<td style="text-align: left;">Can be trickier to debug in graph mode; eager mode helps but is relatively newer.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Deployment &amp; Production</strong></td>
<td style="text-align: left;">TorchServe and growing enterprise support, but historically overshadowed by TensorFlow’s tools.</td>
<td style="text-align: left;">TensorFlow Serving, TensorFlow Lite, and easy Google Cloud integration.</td>
</tr>
</tbody>
</table>
<aside class="notes">
<p>While the fundamental math and building blocks are similar, the biggest difference typically lies in how you prototype, debug, and deploy models.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="similarities" class="slide level2 center">
<h2>Similarities</h2>
<table class="caption-top">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Similarity</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Wide Range of Neural Network Layers</strong></td>
<td style="text-align: left;">Convolutional, Recurrent, Transformers, etc. Both frameworks maintain robust libraries for standard and advanced layers.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Auto-Differentiation</strong></td>
<td style="text-align: left;">No need to manually compute gradients; backpropagation is handled automatically.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>GPU Acceleration</strong></td>
<td style="text-align: left;">Both leverage CUDA (NVIDIA GPUs) or other backends to speed up training.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Rich Communities</strong></td>
<td style="text-align: left;">Abundant tutorials, example code, pretrained models, and Q&amp;A forums.</td>
</tr>
</tbody>
</table>
<aside class="notes">
<p>Despite differing philosophies, PyTorch and TensorFlow share many core functionalities and have large, supportive user communities.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="comparison-of-advantages-and-disadvantages" class="slide level2 center">
<h2>Comparison of Advantages and Disadvantages</h2>
<div style="font-size: 80%;">
<table class="caption-top">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: left;"><strong>PyTorch</strong></th>
<th style="text-align: left;"><strong>TensorFlow</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Advantages</strong></td>
<td style="text-align: left;">- <strong>Intuitive, Pythonic Syntax</strong>: Feels like standard Python, reducing friction for experimentation <br> - <strong>Dynamic Graph Execution</strong>: Simplifies debugging and model design <br> - <strong>Research &amp; Academia Favorite</strong>: widely used in cutting-edge papers</td>
<td style="text-align: left;">- <strong>Static Graph Optimization</strong>: Graph-based execution can be highly optimized for speed and memory usage <br> - <strong>Extensive Production Ecosystem</strong>: Includes TensorFlow Serving, TensorFlow Lite, TFX for data pipelines <br> - <strong>Large Corporate Adoption</strong>: Backed by Google, widely used in enterprise settings</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Disadvantages</strong></td>
<td style="text-align: left;">- <strong>Deployment Maturity</strong>: Production tooling and ecosystem are improving but still behind TensorFlow <br> - <strong>Smaller Enterprise Adoption</strong>: Historically overshadowed by TensorFlow’s widespread adoption</td>
<td style="text-align: left;">- <strong>Learning Curve</strong>: The graph-based approach can be challenging for newcomers <br> - <strong>Historically Less Intuitive</strong>: Older APIs and tutorials can be confusing, though Eager Mode improves usability</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="recommendations" class="slide level2 center">
<h2>Recommendations</h2>
<div class="columns">
<div class="column">
<h3 id="choose-pytorch-if">Choose <strong>PyTorch</strong> if:</h3>
<ul>
<li class="fragment">Your focus is on <strong>rapid experimentation</strong> and <strong>academic research</strong></li>
<li class="fragment">You prioritize a <strong>Pythonic workflow</strong> and easy debugging</li>
<li class="fragment">You prefer a <a href="https://pytorch.org/blog/computational-graphs-constructed-in-pytorch/" target="_blank"><strong>dynamic graph</strong> approach</a> (<a href="https://medium.com/@serverwalainfra/understanding-pytorchs-dynamic-computational-graphs-bf77ee51e5c8" target="_blank">about it</a>).</li>
<li class="fragment">You are working on cutting-edge models with high flexibility</li>
<li class="fragment">You value seamless interaction with Python libraries</li>
</ul>
</div><div class="column">
<h3 id="choose-tensorflow-if">Choose <strong>TensorFlow</strong> if:</h3>
<ul>
<li class="fragment">You need <strong>robust production</strong> and <strong>deployment pipelines</strong></li>
<li class="fragment">You plan to integrate with <strong>Google Cloud</strong> services</li>
<li class="fragment">You require support for <strong>mobile/edge devices</strong> (e.g., TensorFlow Lite)</li>
<li class="fragment">You benefit from <strong>static graph optimization</strong> for performance</li>
<li class="fragment">You want an <strong>end-to-end ecosystem</strong> (TFX, TensorBoard, Serving)</li>
</ul>
</div></div>
<!----

XXXXXXXXXXXX

## Conclusion

- **Both Frameworks Are Necessary**  
  - They address core problems in deep learning: high-level APIs, automatic differentiation, and efficient hardware usage.
- **Decision Factors**  
  - Project goals (research vs. production), team expertise, ecosystem preference, and existing infrastructure.
- **Stay Flexible**  
  - Both PyTorch and TensorFlow evolve rapidly, so keep an eye on new releases and community developments.

:::{.notes}
Framework preference often comes down to familiarity and project scope. Ultimately, both PyTorch and TensorFlow are powerful, widely adopted, and actively improving.
:::

XXXXXXXXXXXXXXXXx

--->
</section></section>
<section>
<section id="pytorch" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>PyTorch</h1>
<!---
<br>


::: {.cell layout-align="center" width='45%'}
::: {.cell-output-display}
![](figs/pytorch_logo.png){fig-align='center' width=430}
:::
:::


<br>

<br>
--->
</section>
<section id="tensors-in-pytorch" class="slide level2 center">
<h2><a href="https://pytorch.org/tutorials/beginner/basics/tensorqs_tutorial.html" target="_blank">Tensors in PyTorch</a></h2>
<iframe src="https://pytorch.org/tutorials/beginner/basics/tensorqs_tutorial.html" width="100%" height="600" allowfullscreen="" sandbox="allow-same-origin allow-scripts allow-popups">
</iframe>
</section>
<section id="datasets-dataloaders" class="slide level2 center">
<h2><a href="https://pytorch.org/tutorials/beginner/basics/data_tutorial.html" target="_blank">Datasets &amp; DataLoaders</a></h2>
<iframe src="https://pytorch.org/tutorials/beginner/basics/data_tutorial.html" width="100%" height="600" allowfullscreen="" sandbox="allow-same-origin allow-scripts allow-popups">
</iframe>
</section>
<section id="datasets-dataloaders-1" class="slide level2 center">
<h2><a href="https://pytorch.org/tutorials/beginner/basics/data_tutorial.html" target="_blank">Datasets &amp; DataLoaders</a></h2>
<div class="slide-font-small" style="font-size: 80%;">
<div class="columns">
<div class="column" style="width:50%;">
<p>The code below extracts a single image‑tensor from the <code>training_data</code> used in the tutorial (you can use <code>test_data</code> the same way), prints its basic properties, and visualizes it.</p>
<div class="cell" style="font-size: 80%;">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="im">import</span> torch</span>
<span id="cb1-2"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a></a></span>
<span id="cb1-4"><a></a><span class="co"># Choose the index of the image you wish to inspect</span></span>
<span id="cb1-5"><a></a>idx <span class="op">=</span> <span class="dv">0</span>  <span class="co"># e.g., the first image; change as desired</span></span>
<span id="cb1-6"><a></a></span>
<span id="cb1-7"><a></a><span class="co"># Fetch the sample</span></span>
<span id="cb1-8"><a></a>image_tensor, label <span class="op">=</span> training_data[idx]   <span class="co"># image_tensor is a 1×28×28 tensor</span></span>
<span id="cb1-9"><a></a></span>
<span id="cb1-10"><a></a><span class="co"># Inspect the raw tensor values</span></span>
<span id="cb1-11"><a></a><span class="bu">print</span>(<span class="st">"Shape :"</span>, image_tensor.shape)  <span class="co"># torch.Size([1, 28, 28])</span></span>
<span id="cb1-12"><a></a><span class="bu">print</span>(<span class="st">"Label :"</span>, label) <span class="co"># integer class id</span></span>
<span id="cb1-13"><a></a><span class="bu">print</span>(<span class="st">"Tensor (first 5 rows):</span><span class="ch">\n</span><span class="st">"</span>, image_tensor[<span class="dv">0</span>, :<span class="dv">5</span>, :])</span>
<span id="cb1-14"><a></a></span>
<span id="cb1-15"><a></a><span class="co"># Visualize the image</span></span>
<span id="cb1-16"><a></a>plt.imshow(image_tensor.squeeze(), cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb1-17"><a></a>plt.title(<span class="ss">f"Fashion‑MNIST class</span><span class="sc">{</span>label<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-18"><a></a>plt.axis(<span class="st">"off"</span>)</span>
<span id="cb1-19"><a></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>How it works</strong></p>
<ol type="1">
<li class="fragment"><strong>Index selection</strong> – set <code>idx</code> to any integer in <code>range(len(training_data))</code>.<br>
</li>
<li class="fragment"><strong>Dataset access</strong> – indexing the dataset returns <code>(image, label)</code> with the transform already applied (here, <code>ToTensor()</code> scales to <code>[0,1]</code>).<br>
</li>
<li class="fragment"><strong>Inspection</strong> – the printed tensor slice lets you verify pixel values, and <code>plt.imshow</code> renders the sample for visual confirmation.</li>
</ol>
<ul>
<li class="fragment">To see a different image you just need to adjust the index.</li>
</ul>
</div></div>
</div>
</section>
<section id="transforms" class="slide level2 center">
<h2><a href="https://pytorch.org/tutorials/beginner/basics/transforms_tutorial.html" target="_blank">Transforms</a></h2>
<iframe src="https://pytorch.org/tutorials/beginner/basics/transforms_tutorial.html" width="100%" height="600" allowfullscreen="" sandbox="allow-same-origin allow-scripts allow-popups">
</iframe>
</section>
<section id="build-the-neural-network" class="slide level2 center">
<h2><a href="https://pytorch.org/tutorials/beginner/basics/buildmodel_tutorial.html" target="_blank">Build the Neural Network</a></h2>
<iframe src="https://pytorch.org/tutorials/beginner/basics/buildmodel_tutorial.html" width="100%" height="600" allowfullscreen="" sandbox="allow-same-origin allow-scripts allow-popups">
</iframe>
</section>
<section id="build-the-neural-network-1" class="slide level2 center">
<h2><a href="https://pytorch.org/tutorials/beginner/basics/buildmodel_tutorial.html" target="_blank">Build the Neural Network</a></h2>
<div style="font-size: 70%;">
<div class="columns">
<div class="column" style="width:50%;">
<p>We define our neural network by subclassing <code>nn.Module</code>, and initialize the neural network layers in <code>__init__</code>. Every <code>nn.Module</code> subclass implements the operations on input data in the <code>forward</code> method.</p>
<p><br></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a></a><span class="kw">class</span> NeuralNetwork(nn.Module):</span>
<span id="cb2-2"><a></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb2-3"><a></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb2-4"><a></a>        <span class="va">self</span>.flatten <span class="op">=</span> nn.Flatten()</span>
<span id="cb2-5"><a></a>        <span class="va">self</span>.linear_relu_stack <span class="op">=</span> nn.Sequential(</span>
<span id="cb2-6"><a></a>            nn.Linear(<span class="dv">28</span><span class="op">*</span><span class="dv">28</span>, <span class="dv">512</span>),</span>
<span id="cb2-7"><a></a>            nn.ReLU(),</span>
<span id="cb2-8"><a></a>            nn.Linear(<span class="dv">512</span>, <span class="dv">512</span>),</span>
<span id="cb2-9"><a></a>            nn.ReLU(),</span>
<span id="cb2-10"><a></a>            nn.Linear(<span class="dv">512</span>, <span class="dv">10</span>),</span>
<span id="cb2-11"><a></a>        )</span>
<span id="cb2-12"><a></a></span>
<span id="cb2-13"><a></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb2-14"><a></a>        x <span class="op">=</span> <span class="va">self</span>.flatten(x)</span>
<span id="cb2-15"><a></a>        logits <span class="op">=</span> <span class="va">self</span>.linear_relu_stack(x)</span>
<span id="cb2-16"><a></a>        <span class="cf">return</span> logits</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>What Are We Doing?</strong></p>
<p>We are defining a <strong>neural network class</strong> using PyTorch. This network is designed to work with images, specifically 28×28 grayscale images like those from the <strong>FashionMNIST</strong> dataset. The network will output <strong>10 values</strong>, one for each digit from 0 to 9.</p>
<p><strong>Step-by-Step Breakdown</strong></p>
<ul>
<li class="fragment"><p><code>class NeuralNetwork(nn.Module):</code></p>
<ul>
<li class="fragment">We create a new neural network class called <code>NeuralNetwork</code>. It inherits from PyTorch’s <code>nn.Module</code>, which is the base class for all neural network models.</li>
</ul></li>
<li class="fragment"><p><code>def __init__(self):</code> and <code>super().__init__()</code></p>
<ul>
<li class="fragment"><code>__init__</code> is the <strong>constructor</strong>. It’s run when we create the model.</li>
<li class="fragment"><code>super().__init__()</code> tells Python to also run the initialization code from the parent class (<code>nn.Module</code>). This is required for PyTorch to keep track of everything inside the model.</li>
</ul></li>
<li class="fragment"><p><code>self.flatten = nn.Flatten()</code>:</p>
<ul>
<li class="fragment">changes the input from a <strong>2D image (28×28)</strong> into a <strong>1D vector (784 values)</strong>, which is easier for linear layers to handle.</li>
</ul></li>
</ul>
</div></div>
</div>
</section>
<section id="build-the-neural-network-2" class="slide level2 center">
<h2><a href="https://pytorch.org/tutorials/beginner/basics/buildmodel_tutorial.html" target="_blank">Build the Neural Network</a></h2>
<div style="font-size: 70%;">
<div class="columns">
<div class="column" style="width:50%;">
<p>We define our neural network by subclassing <code>nn.Module</code>, and initialize the neural network layers in <code>__init__</code>. Every <code>nn.Module</code> subclass implements the operations on input data in the <code>forward</code> method.</p>
<p><br></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a><span class="kw">class</span> NeuralNetwork(nn.Module):</span>
<span id="cb3-2"><a></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb3-3"><a></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb3-4"><a></a>        <span class="va">self</span>.flatten <span class="op">=</span> nn.Flatten()</span>
<span id="cb3-5"><a></a>        <span class="va">self</span>.linear_relu_stack <span class="op">=</span> nn.Sequential(</span>
<span id="cb3-6"><a></a>            nn.Linear(<span class="dv">28</span><span class="op">*</span><span class="dv">28</span>, <span class="dv">512</span>),</span>
<span id="cb3-7"><a></a>            nn.ReLU(),</span>
<span id="cb3-8"><a></a>            nn.Linear(<span class="dv">512</span>, <span class="dv">512</span>),</span>
<span id="cb3-9"><a></a>            nn.ReLU(),</span>
<span id="cb3-10"><a></a>            nn.Linear(<span class="dv">512</span>, <span class="dv">10</span>),</span>
<span id="cb3-11"><a></a>        )</span>
<span id="cb3-12"><a></a></span>
<span id="cb3-13"><a></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb3-14"><a></a>        x <span class="op">=</span> <span class="va">self</span>.flatten(x)</span>
<span id="cb3-15"><a></a>        logits <span class="op">=</span> <span class="va">self</span>.linear_relu_stack(x)</span>
<span id="cb3-16"><a></a>        <span class="cf">return</span> logits</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Define a sequence of layers:</strong></p>
<p>Here we build the main body of the neural network.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a><span class="va">self</span>.linear_relu_stack <span class="op">=</span> nn.Sequential(</span>
<span id="cb4-2"><a></a>    nn.Linear(<span class="dv">28</span><span class="op">*</span><span class="dv">28</span>, <span class="dv">512</span>),</span>
<span id="cb4-3"><a></a>    nn.ReLU(),</span>
<span id="cb4-4"><a></a>    nn.Linear(<span class="dv">512</span>, <span class="dv">512</span>),</span>
<span id="cb4-5"><a></a>    nn.ReLU(),</span>
<span id="cb4-6"><a></a>    nn.Linear(<span class="dv">512</span>, <span class="dv">10</span>),</span>
<span id="cb4-7"><a></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>In most contexts when we say “how many layers?” we refer to the learnable ones. So this network has <strong>three fully‑connected (Linear) layers, with ReLU activations in between</strong>.</p>
<ul>
<li class="fragment">You can think of the linear layer as a <strong>filter</strong> that projects the image into a <strong>new space with 512 dimensions</strong>. These new values are <strong>not pixels</strong> anymore, but rather <strong>abstract features</strong> learned by the network.</li>
</ul>
</div></div>
</div>
</section>
<section id="build-the-neural-network-3" class="slide level2 center">
<h2><a href="https://pytorch.org/tutorials/beginner/basics/buildmodel_tutorial.html" target="_blank">Build the Neural Network</a></h2>
<div style="font-size: 70%;">
<div class="columns">
<div class="column" style="width:50%;">
<p>We define our neural network by subclassing <code>nn.Module</code>, and initialize the neural network layers in <code>__init__</code>. Every <code>nn.Module</code> subclass implements the operations on input data in the <code>forward</code> method.</p>
<p><br></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a></a><span class="kw">class</span> NeuralNetwork(nn.Module):</span>
<span id="cb5-2"><a></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb5-3"><a></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb5-4"><a></a>        <span class="va">self</span>.flatten <span class="op">=</span> nn.Flatten()</span>
<span id="cb5-5"><a></a>        <span class="va">self</span>.linear_relu_stack <span class="op">=</span> nn.Sequential(</span>
<span id="cb5-6"><a></a>            nn.Linear(<span class="dv">28</span><span class="op">*</span><span class="dv">28</span>, <span class="dv">512</span>),</span>
<span id="cb5-7"><a></a>            nn.ReLU(),</span>
<span id="cb5-8"><a></a>            nn.Linear(<span class="dv">512</span>, <span class="dv">512</span>),</span>
<span id="cb5-9"><a></a>            nn.ReLU(),</span>
<span id="cb5-10"><a></a>            nn.Linear(<span class="dv">512</span>, <span class="dv">10</span>),</span>
<span id="cb5-11"><a></a>        )</span>
<span id="cb5-12"><a></a></span>
<span id="cb5-13"><a></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb5-14"><a></a>        x <span class="op">=</span> <span class="va">self</span>.flatten(x)</span>
<span id="cb5-15"><a></a>        logits <span class="op">=</span> <span class="va">self</span>.linear_relu_stack(x)</span>
<span id="cb5-16"><a></a>        <span class="cf">return</span> logits</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Define a sequence of layers:</strong></p>
<ol type="1">
<li class="fragment"><strong>First layer</strong> <code>nn.Linear(28*28, 512)</code>: takes the 784 values from the image and transforms them into 512 values. A <code>Linear(784, 512)</code> layer performs:
<ul>
<li class="fragment">A <strong>matrix multiplication</strong> between the input vector (length 784) and a <strong>weight matrix</strong> of size <code>[784 × 512]</code>, followed by adding a <strong>bias vector</strong> of length 512.</li>
<li class="fragment">Mathematically: <span class="math display">\[
\text{output} = x \cdot W + b
\]</span></li>
<li class="fragment"><code>x</code> is the <strong>input vector</strong>: shape <code>[784]</code></li>
<li class="fragment"><code>W</code> is the <strong>weight matrix</strong>: shape <code>[784 × 512]</code></li>
<li class="fragment"><code>b</code> is the <strong>bias vector</strong>: shape <code>[512]</code></li>
<li class="fragment">The result (<code>output</code>) is a new vector of shape <code>[512]</code></li>
</ul></li>
</ol>
<ul>
<li class="fragment">Each of the 512 output values is a <strong>linear combination</strong> of all 784 pixel values in the input image. By default, PyTorch initializes weights using <a href="https://en.wikipedia.org/wiki/Weight_initialization" target="_blank">Kaiming Uniform Initialization</a> (a variant of <a href="https://en.wikipedia.org/wiki/Weight_initialization" target="_blank">He initialization</a>), which works well with ReLU activation functions.</li>
</ul>
</div></div>
</div>
</section>
<section id="build-the-neural-network-4" class="slide level2 center">
<h2><a href="https://pytorch.org/tutorials/beginner/basics/buildmodel_tutorial.html" target="_blank">Build the Neural Network</a></h2>
<div style="font-size: 70%;">
<div class="columns">
<div class="column" style="width:50%;">
<p>We define our neural network by subclassing <code>nn.Module</code>, and initialize the neural network layers in <code>__init__</code>. Every <code>nn.Module</code> subclass implements the operations on input data in the <code>forward</code> method.</p>
<p><br></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a></a><span class="kw">class</span> NeuralNetwork(nn.Module):</span>
<span id="cb6-2"><a></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb6-3"><a></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb6-4"><a></a>        <span class="va">self</span>.flatten <span class="op">=</span> nn.Flatten()</span>
<span id="cb6-5"><a></a>        <span class="va">self</span>.linear_relu_stack <span class="op">=</span> nn.Sequential(</span>
<span id="cb6-6"><a></a>            nn.Linear(<span class="dv">28</span><span class="op">*</span><span class="dv">28</span>, <span class="dv">512</span>),</span>
<span id="cb6-7"><a></a>            nn.ReLU(),</span>
<span id="cb6-8"><a></a>            nn.Linear(<span class="dv">512</span>, <span class="dv">512</span>),</span>
<span id="cb6-9"><a></a>            nn.ReLU(),</span>
<span id="cb6-10"><a></a>            nn.Linear(<span class="dv">512</span>, <span class="dv">10</span>),</span>
<span id="cb6-11"><a></a>        )</span>
<span id="cb6-12"><a></a></span>
<span id="cb6-13"><a></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb6-14"><a></a>        x <span class="op">=</span> <span class="va">self</span>.flatten(x)</span>
<span id="cb6-15"><a></a>        logits <span class="op">=</span> <span class="va">self</span>.linear_relu_stack(x)</span>
<span id="cb6-16"><a></a>        <span class="cf">return</span> logits</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Define a sequence of layers:</strong></p>
<ol start="2" type="1">
<li class="fragment"><p><code>nn.ReLU()</code>: applies the <a href="https://en.wikipedia.org/wiki/Rectifier_(neural_networks)" target="_blank"><strong>ReLU activation function</strong></a>, which keeps positive numbers and turns negative numbers into zero. This adds non-linearity to the model.</p></li>
<li class="fragment"><p><strong>Second layer</strong><code>nn.Linear(512, 512)</code>: takes those 512 values and again outputs 512 values. This is a <strong>hidden layer</strong>, helping the model learn more complex patterns.</p></li>
<li class="fragment"><p><code>nn.ReLU()</code>: Another non-linear transformation.</p></li>
<li class="fragment"><p><strong>Third (Final) layer</strong>:<code>nn.Linear(512, 10)</code>: takes the 512 values and produces <strong>10 output values</strong>.</p>
<ul>
<li class="fragment">These are called <strong>logits</strong>, and each one corresponds to a digit class (0 to 9).</li>
</ul></li>
</ol>
</div></div>
</div>
</section>
<section id="build-the-neural-network-5" class="slide level2 center">
<h2><a href="https://pytorch.org/tutorials/beginner/basics/buildmodel_tutorial.html" target="_blank">Build the Neural Network</a></h2>
<div style="font-size: 70%;">
<div class="columns">
<div class="column" style="width:50%;">
<p>We define our neural network by subclassing <code>nn.Module</code>, and initialize the neural network layers in <code>__init__</code>. Every <code>nn.Module</code> subclass implements the operations on input data in the <code>forward</code> method.</p>
<p><br></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a></a><span class="kw">class</span> NeuralNetwork(nn.Module):</span>
<span id="cb7-2"><a></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb7-3"><a></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb7-4"><a></a>        <span class="va">self</span>.flatten <span class="op">=</span> nn.Flatten()</span>
<span id="cb7-5"><a></a>        <span class="va">self</span>.linear_relu_stack <span class="op">=</span> nn.Sequential(</span>
<span id="cb7-6"><a></a>            nn.Linear(<span class="dv">28</span><span class="op">*</span><span class="dv">28</span>, <span class="dv">512</span>),</span>
<span id="cb7-7"><a></a>            nn.ReLU(),</span>
<span id="cb7-8"><a></a>            nn.Linear(<span class="dv">512</span>, <span class="dv">512</span>),</span>
<span id="cb7-9"><a></a>            nn.ReLU(),</span>
<span id="cb7-10"><a></a>            nn.Linear(<span class="dv">512</span>, <span class="dv">10</span>),</span>
<span id="cb7-11"><a></a>        )</span>
<span id="cb7-12"><a></a></span>
<span id="cb7-13"><a></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb7-14"><a></a>        x <span class="op">=</span> <span class="va">self</span>.flatten(x)</span>
<span id="cb7-15"><a></a>        logits <span class="op">=</span> <span class="va">self</span>.linear_relu_stack(x)</span>
<span id="cb7-16"><a></a>        <span class="cf">return</span> logits</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Define a sequence of layers:</strong></p>
<ul>
<li class="fragment"><p><code>forward(self, x)</code>: This is the <strong>forward pass</strong>, the function that runs when we send data through the model.</p></li>
<li class="fragment"><p>Step-by-step:</p></li>
</ul>
<ol type="1">
<li class="fragment"><p><code>x = self.flatten(x)</code>: Convert the 28×28 image into a 1D tensor with 784 values.</p></li>
<li class="fragment"><p><code>logits = self.linear_relu_stack(x)</code>: Pass the input through the series of layers.</p></li>
<li class="fragment"><p><code>return logits</code>: Output the final predictions (raw scores for each class).</p></li>
</ol>
<ul>
<li class="fragment">In summary this neural network:
<ul>
<li class="fragment">Takes an image (28×28) as input,</li>
<li class="fragment">Flattens it into a vector,</li>
<li class="fragment">Passes it through two <strong>fully connected layers</strong> with ReLU,</li>
<li class="fragment">Outputs a vector of size 10 (one for each digit)</li>
</ul></li>
</ul>
</div></div>
</div>
</section>
<section id="build-the-neural-network-6" class="slide level2 center">
<h2><a href="https://pytorch.org/tutorials/beginner/basics/buildmodel_tutorial.html" target="_blank">Build the Neural Network</a></h2>
<div style="font-size: 60%;">
<div class="columns">
<div class="column" style="width:50%;">
<p>We create an instance of <code>NeuralNetwork</code>, and move it to the <code>device</code>, and print its structure.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a></a>model <span class="op">=</span> NeuralNetwork().to(device)</span>
<span id="cb8-2"><a></a><span class="bu">print</span>(model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>To use the model, we pass it the input data.</p>
<p><strong>Example</strong>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a></a>X <span class="op">=</span> torch.rand(<span class="dv">1</span>, <span class="dv">28</span>, <span class="dv">28</span>, device<span class="op">=</span>device)</span>
<span id="cb9-2"><a></a>logits <span class="op">=</span> model(X)</span>
<span id="cb9-3"><a></a>pred_probab <span class="op">=</span> nn.Softmax(dim<span class="op">=</span><span class="dv">1</span>)(logits)</span>
<span id="cb9-4"><a></a>y_pred <span class="op">=</span> pred_probab.argmax(<span class="dv">1</span>)</span>
<span id="cb9-5"><a></a><span class="bu">print</span>(<span class="ss">f"Predicted class: </span><span class="sc">{</span>y_pred<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-6"><a></a></span>
<span id="cb9-7"><a></a><span class="co"># To see the image:</span></span>
<span id="cb9-8"><a></a><span class="im">import</span> torch</span>
<span id="cb9-9"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb9-10"><a></a></span>
<span id="cb9-11"><a></a><span class="co"># Remove the batch dimension (1, 28, 28) → (28, 28)</span></span>
<span id="cb9-12"><a></a>image <span class="op">=</span> X[<span class="dv">0</span>]</span>
<span id="cb9-13"><a></a></span>
<span id="cb9-14"><a></a><span class="co"># Plot the image</span></span>
<span id="cb9-15"><a></a>plt.imshow(image, cmap<span class="op">=</span><span class="st">'gray'</span>)  <span class="co"># Use 'gray' colormap for grayscale image</span></span>
<span id="cb9-16"><a></a>plt.title(<span class="st">"Random 28x28 Image"</span>)</span>
<span id="cb9-17"><a></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb9-18"><a></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment"><code>torch.rand(1, 28, 28, device=device)</code>: Creates a <strong>random image</strong> with shape <code>[1, 28, 28]</code>
<ul>
<li class="fragment"><code>1</code> is the batch size (just one image)</li>
<li class="fragment"><code>28×28</code> is the image dimension</li>
<li class="fragment"><code>device=device</code> ensures the tensor goes to CPU or GPU (wherever the model is)</li>
</ul></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a></a><span class="co"># To see tensor:</span></span>
<span id="cb10-2"><a></a><span class="bu">print</span>(X)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div class="fragment">
<p>Let’s say the tensor shown is:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a></a>X <span class="op">=</span> torch.tensor([[</span>
<span id="cb11-2"><a></a>    [<span class="fl">0.1177</span>, <span class="fl">0.2669</span>, <span class="fl">0.6367</span>, <span class="fl">0.6148</span>, <span class="fl">0.3085</span>, ...],  <span class="co"># row 0</span></span>
<span id="cb11-3"><a></a>    [<span class="fl">0.8672</span>, <span class="fl">0.3645</span>, <span class="fl">0.4822</span>, <span class="fl">0.9566</span>, <span class="fl">0.8999</span>, ...],  <span class="co"># row 1</span></span>
<span id="cb11-4"><a></a>    ...</span>
<span id="cb11-5"><a></a>]])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li class="fragment">This is a <strong>3D tensor</strong> of shape <code>[1, 28, 28]</code>:
<ul>
<li class="fragment">The first dimension <code>1</code> is the batch size,</li>
<li class="fragment">The next two are height and width of the image.</li>
</ul></li>
<li class="fragment">The full index of <code>0.2669</code> in the 3D tensor is: <code>X[0, 0, 1]</code>.
<ul>
<li class="fragment"><code>0</code> → first (and only) image in the batch</li>
<li class="fragment"><code>0</code> → first row of the image</li>
<li class="fragment"><code>1</code> → second column in that row</li>
</ul></li>
</ul>
</div></div>
</div>
</section>
<section id="build-the-neural-network-7" class="slide level2 center">
<h2><a href="https://pytorch.org/tutorials/beginner/basics/buildmodel_tutorial.html" target="_blank">Build the Neural Network</a></h2>
<div style="font-size: 70%;">
<div class="columns">
<div class="column" style="width:50%;">
<p>We create an instance of <code>NeuralNetwork</code>, and move it to the <code>device</code>, and print its structure.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a></a>model <span class="op">=</span> NeuralNetwork().to(device)</span>
<span id="cb12-2"><a></a><span class="bu">print</span>(model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>To use the model, we pass it the input data.</p>
<p><strong>Example</strong>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a></a>X <span class="op">=</span> torch.rand(<span class="dv">1</span>, <span class="dv">28</span>, <span class="dv">28</span>, device<span class="op">=</span>device)</span>
<span id="cb13-2"><a></a>logits <span class="op">=</span> model(X)</span>
<span id="cb13-3"><a></a>pred_probab <span class="op">=</span> nn.Softmax(dim<span class="op">=</span><span class="dv">1</span>)(logits)</span>
<span id="cb13-4"><a></a>y_pred <span class="op">=</span> pred_probab.argmax(<span class="dv">1</span>)</span>
<span id="cb13-5"><a></a><span class="bu">print</span>(<span class="ss">f"Predicted class: </span><span class="sc">{</span>y_pred<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-6"><a></a></span>
<span id="cb13-7"><a></a><span class="co"># To see the image:</span></span>
<span id="cb13-8"><a></a><span class="im">import</span> torch</span>
<span id="cb13-9"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-10"><a></a></span>
<span id="cb13-11"><a></a><span class="co"># Remove the batch dimension (1, 28, 28) → (28, 28)</span></span>
<span id="cb13-12"><a></a>image <span class="op">=</span> X[<span class="dv">0</span>]</span>
<span id="cb13-13"><a></a></span>
<span id="cb13-14"><a></a><span class="co"># Plot the image</span></span>
<span id="cb13-15"><a></a>plt.imshow(image, cmap<span class="op">=</span><span class="st">'gray'</span>)  <span class="co"># Use 'gray' colormap for grayscale image</span></span>
<span id="cb13-16"><a></a>plt.title(<span class="st">"Random 28x28 Image"</span>)</span>
<span id="cb13-17"><a></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb13-18"><a></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment"><p><code>logits = model(X)</code>: This <strong>calls the model</strong> with input <code>X</code>.</p>
<ul>
<li class="fragment">Behind the scenes, it runs <code>model.forward(X)</code></li>
<li class="fragment">Output: a <strong>vector of 10 values</strong> (called logits), one for each class (digits 0 through 9)</li>
</ul></li>
<li class="fragment"><p><strong>Note</strong>: We do <strong>not</strong> call <code>model.forward()</code> directly — <code>PyTorch</code> manages hooks and gradients when we use <code>model(X)</code></p></li>
<li class="fragment"><p><code>pred_probab = nn.Softmax(dim=1)(logits)</code>: Applies <strong>softmax</strong> to the raw output logits</p>
<ul>
<li class="fragment">Softmax turns logits into <strong>probabilities</strong> (values between 0 and 1 that sum to 1)</li>
<li class="fragment"><code>dim=1</code> means we apply softmax across the 10 output class values (not across the batch)</li>
</ul></li>
<li class="fragment"><p><code>y_pred = pred_probab.argmax(1)</code>: Picks the <strong>index of the largest probability</strong>, i.e., the <strong>predicted class</strong></p>
<ul>
<li class="fragment"><code>argmax(1)</code> returns the class with the highest probability from each row (here we have just one row)</li>
</ul></li>
<li class="fragment"><p><code>print(f"Predicted class: {y_pred}")</code>: Prints the predicted digit class (0 through 9)</p></li>
</ul>
</div></div>
</div>
</section>
<section id="automatic-differentiation-with-torch.autograd" class="slide level2 center">
<h2><a href="https://pytorch.org/tutorials/beginner/basics/autogradqs_tutorial.html" target="_blank">Automatic Differentiation with torch.autograd</a></h2>
<iframe src="https://pytorch.org/tutorials/beginner/basics/autogradqs_tutorial.html" width="100%" height="600" allowfullscreen="" sandbox="allow-same-origin allow-scripts allow-popups">
</iframe>
</section>
<section id="optimizing-model-parameters" class="slide level2 center">
<h2><a href="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" target="_blank">Optimizing Model Parameters</a></h2>
<iframe src="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" width="100%" height="600" allowfullscreen="" sandbox="allow-same-origin allow-scripts allow-popups">
</iframe>
</section>
<section id="save-and-load-the-model" class="slide level2 center">
<h2><a href="https://pytorch.org/tutorials/beginner/basics/saveloadrun_tutorial.html" target="_blank">Save and Load the Model</a></h2>
<iframe src="https://pytorch.org/tutorials/beginner/basics/saveloadrun_tutorial.html" width="100%" height="600" allowfullscreen="" sandbox="allow-same-origin allow-scripts allow-popups">
</iframe>
</section></section>
<section>
<section id="your-turn" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Your turn!</h1>

</section>
<section id="introduction-to-pytorch---youtube-series" class="slide level2 center">
<h2><a href="https://pytorch.org/tutorials/beginner/introyt/introyt1_tutorial.html" target="_blank">Introduction to PyTorch - YouTube Series</a></h2>
<iframe src="https://pytorch.org/tutorials/beginner/introyt/introyt1_tutorial.html" width="100%" height="600" allowfullscreen="" sandbox="allow-same-origin allow-scripts allow-popups">
</iframe>
<center>
<em>Pro tip: Use Colab with a GPU runtime to speed up operations Runtime &gt; Change runtime type &gt; GPU</em>
</center>
</section></section>
<section>
<section id="neural-networks" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Neural Networks</h1>

</section>
<section id="neural-networks---video" class="slide level2 center">
<h2>Neural Networks - Video</h2>
<p><br></p>
<center>
<iframe width="800" height="450" src="https://www.youtube.com/embed/aircAruvnKk" title="But what is a neural network?" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
</center>
<center>
<a href="https://www.youtube.com/embed/aircAruvnKk" target="_blank">But what is a neural network?</a>
</center>
</section></section>
<section>
<section id="single-layer-neural-network" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Single Layer Neural Network</h1>

</section>
<section id="single-layer-neural-network-1" class="slide level2 center">
<h2>Single Layer Neural Network</h2>
<div style="font-size: 80%;">
<div class="columns">
<div class="column" style="text-align: center; justify-content: center; align-items: center;">
<p><span class="math display">\[
\begin{align*}
f(X) &amp;= \beta_0 + \sum_{k=1}^{K} \beta_k h_k(X) \\
     &amp;= \beta_0 + \sum_{k=1}^{K} \beta_k g\left(w_{k0} + \sum_{j=1}^{p} w_{kj} X_j \right).
\end{align*}
\]</span></p>
</div><div class="column" style="text-align: center; justify-content: center; align-items: center;">
<p><strong>Network Diagram of Single Layer Neural Network</strong></p>
<div class="cell" data-layout-align="center" width="85%">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/10_1-1.png" class="quarto-figure quarto-figure-center" width="618"></p>
</figure>
</div>
</div>
</div>
</div></div>
</div>
</section>
<section id="single-layer-neural-network-introduction-and-layers-overview" class="slide level2 center">
<h2>Single Layer Neural Network: Introduction and Layers Overview</h2>
<div style="font-size: 80%;">
<div class="columns">
<div class="column" style="text-align: center; justify-content: center; align-items: center;">
<p><span class="math display">\[
\begin{align*}
f(X) &amp;= \beta_0 + \sum_{k=1}^{K} \beta_k h_k(X) \\
     &amp;= \beta_0 + \sum_{k=1}^{K} \beta_k g\left(w_{k0} + \sum_{j=1}^{p} w_{kj} X_j \right).
\end{align*}
\]</span></p>
<p><strong>Network Diagram of Single Layer Neural Network</strong></p>
<div class="cell" data-layout-align="center" width="85%">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/10_1-1.png" class="quarto-figure quarto-figure-center" width="618"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="text-align: center; justify-content: center; align-items: center;">
<p>Neural networks are often displayed using <strong>network diagrams</strong>, as shown in the figure.</p>
<ul>
<li class="fragment"><strong>Input Layer (Orange Circles):</strong>
<ul>
<li class="fragment"><span class="math inline">\(X_1, X_2, X_3, X_4\)</span></li>
<li class="fragment">These are observed variables from the dataset.</li>
</ul></li>
<li class="fragment"><strong>Hidden Layer (Blue Circles):</strong>
<ul>
<li class="fragment"><span class="math inline">\(A_1, A_2, A_3, A_4, A_5\)</span></li>
<li class="fragment">These are transformations (activations) computed from the inputs.</li>
</ul></li>
<li class="fragment"><strong>Output Layer (Pink Circle):</strong>
<ul>
<li class="fragment"><span class="math inline">\(f(X) \to Y\)</span></li>
<li class="fragment"><span class="math inline">\(Y\)</span> is also observed, e.g., a label or continuous response.</li>
</ul></li>
</ul>
</div></div>
</div>
</section>
<section id="single-layer-neural-network-observed-vs.-latent" class="slide level2 center">
<h2>Single Layer Neural Network: Observed vs.&nbsp;Latent</h2>
<div style="font-size: 80%;">
<div class="columns">
<div class="column" style="text-align: center; justify-content: center; align-items: center;">
<p><span class="math display">\[
\begin{align*}
f(X) &amp;= \beta_0 + \sum_{k=1}^{K} \beta_k h_k(X) \\
     &amp;= \beta_0 + \sum_{k=1}^{K} \beta_k g\left(w_{k0} + \sum_{j=1}^{p} w_{kj} X_j \right).
\end{align*}
\]</span></p>
<p><strong>Network Diagram of Single Layer Neural Network</strong></p>
<div class="cell" data-layout-align="center" width="85%">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/10_1-1.png" class="quarto-figure quarto-figure-center" width="618"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="text-align: center; justify-content: center; align-items: center;">
<p><strong>Where is the observed data?</strong></p>
<ul>
<li class="fragment"><span class="math inline">\(X_j\)</span> are observed (the input features).</li>
<li class="fragment"><span class="math inline">\(Y\)</span> is observed (the response or label).</li>
<li class="fragment">The <strong>hidden units</strong> (<span class="math inline">\(A_k\)</span>) are <strong>not</strong> observed; they’re learned transformations.</li>
</ul>
</div></div>
</div>
</section>
<section id="single-layer-neural-network-hidden-layer-as-transformations" class="slide level2 center">
<h2>Single Layer Neural Network: Hidden Layer as Transformations</h2>
<div style="font-size: 80%;">
<div class="columns">
<div class="column" style="text-align: center; justify-content: center; align-items: center;">
<p><span class="math display">\[
\begin{align*}
f(X) &amp;= \beta_0 + \sum_{k=1}^{K} \beta_k h_k(X) \\
     &amp;= \beta_0 + \sum_{k=1}^{K} \beta_k g\left(w_{k0} + \sum_{j=1}^{p} w_{kj} X_j \right).
\end{align*}
\]</span></p>
<p><strong>Network Diagram of Single Layer Neural Network</strong></p>
<div class="cell" data-layout-align="center" width="85%">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/10_1-1.png" class="quarto-figure quarto-figure-center" width="618"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="text-align: center; justify-content: center; align-items: center;">
<p>In the hidden layer, each activation <span class="math inline">\(A_k\)</span> is computed as:</p>
<p><span class="math display">\[
A_k = g\Bigl(w_{k0} + \sum_{j=1}^4 w_{kj} X_j\Bigr),
\]</span></p>
<ul>
<li class="fragment">In the formula, these <span class="math inline">\(h_k(X)\)</span> are the same as the activations <span class="math inline">\(A_k\)</span>.</li>
<li class="fragment"><span class="math inline">\(h_k(X)\)</span> = <span class="math inline">\(g(w_{k0} + \sum_{j=1}^p w_{kj} X_j)\)</span>.</li>
<li class="fragment"><span class="math inline">\(g(\cdot)\)</span> is a nonlinear function (e.g., ReLU, sigmoid, tanh).</li>
<li class="fragment"><span class="math inline">\(w_{kj}\)</span> are the weights learned during training.</li>
<li class="fragment">Each hidden unit has a <em>different</em> set of weights, hence different transformations.</li>
</ul>
</div></div>
</div>
</section>
<section id="single-layer-neural-network-training-the-network" class="slide level2 center">
<h2>Single Layer Neural Network: Training the Network</h2>
<div style="font-size: 80%;">
<div class="columns">
<div class="column" style="text-align: center; justify-content: center; align-items: center;">
<p><span class="math display">\[
\begin{align*}
f(X) &amp;= \beta_0 + \sum_{k=1}^{K} \beta_k h_k(X) \\
     &amp;= \beta_0 + \sum_{k=1}^{K} \beta_k g\left(w_{k0} + \sum_{j=1}^{p} w_{kj} X_j \right).
\end{align*}
\]</span></p>
<p><strong>Network Diagram of Single Layer Neural Network</strong></p>
<div class="cell" data-layout-align="center" width="85%">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/10_1-1.png" class="quarto-figure quarto-figure-center" width="618"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="text-align: center; justify-content: center; align-items: center;">
<ul>
<li class="fragment"><p>The network learns all weights <span class="math inline">\(w_{kj}, w_{k0}, \beta_k, \beta_0\)</span> during <strong>training</strong>.</p></li>
<li class="fragment"><p>Objective: predict <span class="math inline">\(Y\)</span> from <span class="math inline">\(X\)</span> accurately.</p></li>
<li class="fragment"><p><strong>Key insight:</strong> Hidden layer learns useful transformations on the fly to help approximate the true function mapping <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span>.</p></li>
</ul>
</div></div>
</div>
</section>
<section id="single-layer-neural-network-details" class="slide level2 center">
<h2>Single Layer Neural Network: Details</h2>
<div style="font-size: 80%;">
<div class="columns">
<div class="column" style="text-align: center; justify-content: center; align-items: center;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/10_2-1.png" class="quarto-figure quarto-figure-center" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="text-align: center; justify-content: center; align-items: center;">
<ul>
<li class="fragment"><p><span class="math inline">\(A_k = h_k(X) = g(w_{k0} + \sum_{j=1}^{p} w_{kj} X_j)\)</span> are called the <strong>activations</strong> in the <em>hidden layer</em>. We can think of it as a non-linear tranformation of a linear function.</p></li>
<li class="fragment"><p><span class="math inline">\(g(z)\)</span> is called the <strong>activation function</strong>. Two popular <strong>activation functions</strong> are: the <strong>sigmoid</strong> and <strong>rectified linear (ReLU)</strong>.</p></li>
<li class="fragment"><p>Activation functions in hidden layers are typically nonlinear; otherwise, the model collapses to a linear model.</p></li>
<li class="fragment"><p>So the activations are like derived features — nonlinear transformations of linear combinations of the features.</p></li>
<li class="fragment"><p>The model is fit by minimizing <span class="math inline">\(\sum_{i=1}^{n} (y_i - f(x_i))^2\)</span> (e.g., for regression).</p></li>
</ul>
</div></div>
</div>
</section>
<section id="nn-example-mnist-digits" class="slide level2 center">
<h2>NN Example: MNIST Digits</h2>
<div style="font-size: 80%;">
<div class="columns">
<div class="column" style="text-align: center; justify-content: center; align-items: center;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/10_3a-1.png" class="quarto-figure quarto-figure-center" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/10_3b-1.png" class="quarto-figure quarto-figure-center" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="text-align: center; justify-content: center; align-items: center;">
<ul>
<li class="fragment"><p><strong>Handwritten digits</strong></p>
<ul>
<li class="fragment"><p><span class="math inline">\(28 \times 28\)</span> grayscale images</p></li>
<li class="fragment"><p>60K train, 10K test images</p></li>
<li class="fragment"><p>Features are the 784 pixel grayscale values <span class="math inline">\(\in (0, 255)\)</span></p></li>
<li class="fragment"><p>Labels are the digit class <span class="math inline">\(0\text{–}9\)</span></p></li>
</ul></li>
<li class="fragment"><p><strong>Goal</strong>: Build a classifier to predict the image class.</p></li>
<li class="fragment"><p>We build a two-layer network with:</p>
<ul>
<li class="fragment"><p>256 units at the first layer,</p></li>
<li class="fragment"><p>128 units at the second layer, and</p></li>
<li class="fragment"><p>10 units at the output layer.</p></li>
</ul></li>
<li class="fragment"><p>Along with intercepts (called <em>biases</em>), there are 235,146 parameters (referred to as <em>weights</em>).</p></li>
</ul>
<div class="fragment">
<center>
<strong>Let’s code!</strong>
</center>
</div>
</div></div>
</div>
<!---

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

## Example: MNIST Digits

::: {style="font-size: 80%;"}

::::: columns
::: {.column width="70%" style="text-align: center; justify-content: center; align-items: center;"}


::: {.cell layout-align="center"}
::: {.cell-output-display}
![](figs/10_4-1.png){fig-align='center' width=85%}
:::
:::


:::

::: {.column width="30%" style="text-align: center; justify-content: center; align-items: center;"}

-   **Handwritten digits**

    -   $28 \times 28$ grayscale images

    -   60K train, 10K test images

    -   Features are the 784 pixel grayscale values $\in (0, 255)$

    -   Labels are the digit class $0\text{–}9$

-   **Goal**: Build a classifier to predict the image class.

-   We build a two-layer network with:

    -   256 units at the first layer,

    -   128 units at the second layer, and

    -   10 units at the output layer.

-   Along with intercepts (called *biases*), there are 235,146 parameters (referred to as *weights*).

:::
:::::
:::



## Details of Output Layer

-   Let $Z_m = \beta_{m0} + \sum_{\ell=1}^{K_2} \beta_{m\ell} A_\ell^{(2)}$, $m = 0, 1, \ldots, 9$, be 10 linear combinations of activations at the second layer.

-   Output activation function encodes the **softmax** function:
$$
f_m(X) = \Pr(Y = m \mid X) = \frac{e^{Z_m}}{\sum_{\ell=0}^{9} e^{Z_\ell}}.
$$

-   We fit the model by minimizing the negative multinomial log-likelihood (or cross-entropy):
$$
-\sum_{i=1}^{n} \sum_{m=0}^{9} y_{im} \log(f_m(x_i)).
$$

-   $y_{im}$ is 1 if the true class for observation $i$ is $m$, else 0 — i.e., *one-hot encoded*.

## Results

| Method                                  | Test Error |
|-----------------------------------------|------------|
| Neural Network + Ridge Regularization   | 2.3%       |
| Neural Network + Dropout Regularization | 1.8%       |
| Multinomial Logistic Regression         | 7.2%       |
| Linear Discriminant Analysis            | 12.7%      |

-   Early success for neural networks in the 1990s.

-   With so many parameters, regularization is essential.

-   Some details of regularization and fitting will come later.

-   Very overworked problem — best reported rates are $< 0.5\%$!

-   Human error rate is reported to be around $0.2\%$, or 20 of the 10K test images.

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
--->
</section></section>
<section>
<section id="fitting-neural-networks" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Fitting Neural Networks</h1>

</section>
<section id="gradient-descent---video" class="slide level2 center">
<h2>Gradient Descent - Video</h2>
<p><br></p>
<center>
<iframe width="800" height="450" src="https://www.youtube.com/embed/IHZwWFHWa-w?list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&amp;index=3" title="Gradient descent, how neural networks learn | DL2" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
</center>
<center>
<a href="https://www.youtube.com/watch?v=IHZwWFHWa-w&amp;list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&amp;index=3" target="_blank">Gradient descent, how neural networks learn</a>
</center>
</section>
<section id="backpropagation-intuition---video" class="slide level2 center">
<h2>Backpropagation Intuition - Video</h2>
<p><br></p>
<center>
<iframe width="800" height="450" src="https://www.youtube.com/embed/Ilg3gGewQ5U?list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&amp;index=3" title="Backpropagation, intuitively" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
</center>
<center>
<a href="https://www.youtube.com/watch?v=Ilg3gGewQ5U&amp;list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&amp;index=3" target="_blank">Backpropagation, intuitively</a>
</center>
</section>
<section id="backpropagation-calculus---video" class="slide level2 center">
<h2>Backpropagation Calculus - Video</h2>
<p><br></p>
<center>
<iframe width="800" height="450" src="https://www.youtube.com/embed/tIeHLnjs5U8?list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&amp;index=4" title="Neural Network Insights" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
</center>
<center>
<a href="https://www.youtube.com/watch?v=tIeHLnjs5U8&amp;list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&amp;index=4" target="_blank">Backpropagation calculus</a>
</center>
</section>
<section id="fitting-neural-networks-1" class="slide level2 center">
<h2>Fitting Neural Networks</h2>
<div class="columns">
<div class="column" style="justify-content: center; align-items: center;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/10_1-1.png" class="quarto-figure quarto-figure-center" style="width:65.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="justify-content: center; align-items: center;">
<p><span class="math display">\[
\min_{\{w_k\}_{1}^K, \beta} \frac{1}{2} \sum_{i=1}^n \left(y_i - f(x_i)\right)^2, \quad \text{where}
\]</span></p>
<p><span class="math display">\[
f(x_i) = \beta_0 + \sum_{k=1}^K \beta_k g\left(w_{k0} + \sum_{j=1}^p w_{kj} x_{ij}\right).
\]</span></p>
<p>This problem is difficult because the objective is <strong>non-convex</strong>.</p>
<p>Despite this, effective algorithms have evolved that can optimize complex neural network problems efficiently.</p>
</div></div>
</section>
<section id="non-convex-functions-and-gradient-descent" class="slide level2 center">
<h2>Non Convex Functions and Gradient Descent</h2>
<p>Let <span class="math inline">\(R(\theta) = \frac{1}{2} \sum_{i=1}^n (y_i - f_\theta(x_i))^2\)</span> with <span class="math inline">\(\theta = (\{w_k\}_{1}^K, \beta)\)</span>.</p>

<img data-src="figs/10_17-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"><ol type="1">
<li class="fragment"><p>Start with a guess <span class="math inline">\(\theta^0\)</span> for all the parameters in <span class="math inline">\(\theta\)</span>, and set <span class="math inline">\(t = 0\)</span>.</p></li>
<li class="fragment"><p>Iterate until the objective <span class="math inline">\(R(\theta)\)</span> fails to decrease:</p>
<ol type="a">
<li class="fragment"><p>Find a vector <span class="math inline">\(\delta\)</span> that reflects a small change in <span class="math inline">\(\theta\)</span>, such that <span class="math inline">\(\theta^{t+1} = \theta^t + \delta\)</span> <strong>reduces</strong> the objective; i.e., <span class="math inline">\(R(\theta^{t+1}) &lt; R(\theta^t)\)</span>.</p></li>
<li class="fragment"><p>Set <span class="math inline">\(t \gets t + 1\)</span>.</p></li>
</ol></li>
</ol>
</section>
<section id="gradient-descent-continued" class="slide level2 center">
<h2>Gradient Descent Continued</h2>
<ul>
<li class="fragment"><p>In this simple example, we reached the <strong>global minimum</strong>.</p></li>
<li class="fragment"><p>If we had started a little to the left of <span class="math inline">\(\theta^0\)</span>, we would have gone in the other direction and ended up in a <strong>local minimum</strong>.</p></li>
<li class="fragment"><p>Although <span class="math inline">\(\theta\)</span> is multi-dimensional, we have depicted the process as one-dimensional. It is much harder to identify whether one is in a local minimum in high dimensions.</p></li>
<li class="fragment"><p>How to find a direction <span class="math inline">\(\delta\)</span> that points downhill? We compute the <strong>gradient vector</strong>: <span class="math display">\[
\nabla R(\theta^t) = \frac{\partial R(\theta)}{\partial \theta} \bigg|_{\theta = \theta^t}
\]</span></p></li>
<li class="fragment"><p>i.e., the vector of <strong>partial derivatives</strong> at the current guess <span class="math inline">\(\theta^t\)</span>.</p></li>
<li class="fragment"><p>The gradient points uphill, so our update is <span class="math inline">\(\delta = - \rho \nabla R(\theta^t)\)</span> or <span class="math display">\[
\theta^{t+1} \gets \theta^t - \rho \nabla R(\theta^t),
\]</span> where <span class="math inline">\(\rho\)</span> is the <strong>learning rate</strong> (typically small, e.g., <span class="math inline">\(\rho = 0.001\)</span>).</p></li>
</ul>
</section>
<section id="gradients-and-backpropagation" class="slide level2 center">
<h2>Gradients and Backpropagation</h2>
<div style="font-size: 80%;">
<p><span class="math display">\[
R(\theta) = \sum_{i=1}^n R_i(\theta) \text{ is a sum, so gradient is sum of gradients.}
\]</span></p>
<p><span class="math display">\[
R_i(\theta) = \frac{1}{2}(y_i - f_\theta(x_i))^2 = \frac{1}{2} \left( y_i - \beta_0 - \sum_{k=1}^K \beta_k g\left( w_{k0} + \sum_{j=1}^p w_{kj} x_{ij} \right) \right)^2
\]</span></p>
<p>For ease of notation, let</p>
<p><span class="math display">\[
z_{ik} = w_{k0} + \sum_{j=1}^p w_{kj} x_{ij}.
\]</span></p>
<p>Backpropagation uses the <strong>chain rule for differentiation</strong>:</p>
<p><span class="math display">\[
\frac{\partial R_i(\theta)}{\partial \beta_k} = \frac{\partial R_i(\theta)}{\partial f_\theta(x_i)} \cdot \frac{\partial f_\theta(x_i)}{\partial \beta_k}
= -(y_i - f_\theta(x_i)) \cdot g(z_{ik}).
\]</span></p>
<p><span class="math display">\[
\frac{\partial R_i(\theta)}{\partial w_{kj}} = \frac{\partial R_i(\theta)}{\partial f_\theta(x_i)} \cdot \frac{\partial f_\theta(x_i)}{\partial g(z_{ik})} \cdot \frac{\partial g(z_{ik})}{\partial z_{ik}} \cdot \frac{\partial z_{ik}}{\partial w_{kj}}
= -(y_i - f_\theta(x_i)) \cdot \beta_k \cdot g'(z_{ik}) \cdot x_{ij}.
\]</span></p>
</div>
</section>
<section id="tricks-of-the-trade" class="slide level2 center">
<h2>Tricks of the Trade</h2>
<ul>
<li class="fragment"><strong>Slow learning.</strong> Gradient descent is slow, and a small learning rate <span class="math inline">\(\rho\)</span> slows it even further. With <em>early stopping</em>, this is a form of regularization.</li>
<li class="fragment"><strong>Stochastic gradient descent.</strong> Rather than compute the gradient using <em>all</em> the data, use a small <em>minibatch</em> drawn at random at each step. E.g. for <em>MNIST</em> data, with <span class="math inline">\(n = 60K\)</span>, we use minibatches of 128 observations.</li>
<li class="fragment"><strong>An epoch</strong> is a count of iterations and amounts to the number of minibatch updates such that <span class="math inline">\(n\)</span> samples in total have been processed; i.e.&nbsp;<span class="math inline">\(60K/128 \approx 469\)</span> for <em>MNIST</em>.</li>
<li class="fragment"><strong>Regularization.</strong> Ridge and lasso regularization can be used to shrink the weights at each layer. Two other popular forms of regularization are <em>dropout</em> and <em>augmentation</em>, discussed next.</li>
</ul>
</section>
<section id="dropout-learning" class="slide level2 center">
<h2>Dropout Learning</h2>

<img data-src="figs/10_1_4-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"><ul>
<li class="fragment"><p><strong>At each Stochastic Gradient Descent (SGD) update</strong>, randomly remove units with probability <span class="math inline">\(\phi\)</span>, and scale up the weights of those retained by <span class="math inline">\(1/(1-\phi)\)</span> to compensate.</p></li>
<li class="fragment"><p>In simple scenarios like linear regression, a version of this process can be shown to be equivalent to ridge regularization.</p></li>
<li class="fragment"><p>As in ridge, the other units <em>stand in</em> for those temporarily removed, and their weights are drawn closer together.</p></li>
<li class="fragment"><p>Similar to randomly omitting variables when growing trees in random forests.</p></li>
</ul>
</section>
<section id="ridge-and-data-augmentation" class="slide level2 center">
<h2>Ridge and Data Augmentation</h2>

<img data-src="figs/10_1_5-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"><ul>
<li class="fragment"><p><strong>Make many copies of each</strong> <span class="math inline">\((x_i, y_i)\)</span> and add a small amount of Gaussian noise to the <span class="math inline">\(x_i\)</span> — a little cloud around each observation — but <em>leave the copies of</em> <span class="math inline">\(y_i\)</span> alone!</p></li>
<li class="fragment"><p>This makes the fit robust to small perturbations in <span class="math inline">\(x_i\)</span>, and is equivalent to ridge regularization in an OLS setting.</p></li>
</ul>
</section>
<section id="data-augmentation-on-the-fly" class="slide level2 center">
<h2>Data Augmentation on the Fly</h2>

<img data-src="figs/10_1_6-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"><ul>
<li class="fragment"><p><strong>Data augmentation</strong> is especially effective with <strong>SGD</strong>, here demonstrated for a CNN and image classification.</p></li>
<li class="fragment"><p>Natural transformations are made of each training image when it is sampled by SGD, thus ultimately making a cloud of images around each original training image.</p></li>
<li class="fragment"><p>The label is left unchanged — in each case still <strong>tiger</strong>.</p></li>
<li class="fragment"><p>Improves performance of CNN and is similar to ridge.</p></li>
</ul>
</section>
<section id="double-descent" class="slide level2 center">
<h2>Double Descent</h2>
<ul>
<li class="fragment"><p><strong>With neural networks</strong>, it seems better to have too many hidden units than too few.</p></li>
<li class="fragment"><p>Likewise more hidden layers better than few.</p></li>
<li class="fragment"><p>Running stochastic gradient descent till zero training error often gives good out-of-sample error.</p></li>
<li class="fragment"><p>Increasing the number of units or layers and again training till zero error sometimes gives <strong>even better</strong> out-of-sample error.</p></li>
<li class="fragment"><p>What happened to overfitting and the usual bias-variance trade-off?</p>
<ul>
<li class="fragment"><em>Belkin, Hsu, Ma, and Mandal (arXiv 2018) Reconciling Modern Machine Learning and the Bias-Variance Trade-off.</em></li>
</ul></li>
</ul>
</section>
<section id="the-double-descent-error-curve" class="slide level2 center">
<h2>The Double-Descent Error Curve</h2>

<img data-src="figs/10_20-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"><ul>
<li class="fragment"><p>When <span class="math inline">\(d \leq 20\)</span>, model is OLS, and we see usual bias-variance trade-off.</p></li>
<li class="fragment"><p>When <span class="math inline">\(d &gt; 20\)</span>, we revert to minimum-norm. As <span class="math inline">\(d\)</span> increases above 20, <span class="math inline">\(\sum_{j=1}^d \hat{\beta}_j^2\)</span> <strong>decreases</strong> since it is easier to achieve zero error, and hence less wiggly solutions.</p></li>
</ul>
</section>
<section id="less-wiggly-solutions" class="slide level2 center">
<h2>Less Wiggly Solutions</h2>

<img data-src="figs/10_21-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"><ul>
<li class="fragment"><p>To achieve a zero-residual solution with <span class="math inline">\(d = 20\)</span> is a real stretch!</p></li>
<li class="fragment"><p>Easier for larger <span class="math inline">\(d\)</span>.</p></li>
</ul>
</section>
<section id="some-facts" class="slide level2 center">
<h2>Some Facts</h2>
<ul>
<li class="fragment"><p>In a wide linear model (<span class="math inline">\(p \gg n\)</span>) fit by least squares, SGD with a small step size leads to a <em>minimum norm</em> zero-residual solution.</p></li>
<li class="fragment"><p>Stochastic gradient <em>flow</em> — i.e.&nbsp;the entire path of SGD solutions — is somewhat similar to ridge path.</p></li>
<li class="fragment"><p>By analogy, deep and wide neural networks fit by SGD down to zero training error often give good solutions that generalize well.</p></li>
<li class="fragment"><p>In particular cases with <em>high signal-to-noise ratio</em> — e.g.&nbsp;image recognition — are less prone to overfitting; the zero-error solution is mostly signal!</p></li>
</ul>
</section></section>
<section>
<section id="convolutional-neural-network-cnn" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Convolutional Neural Network — CNN</h1>

</section>
<section id="cnn-introduction" class="slide level2 center">
<h2>CNN: Introduction</h2>
<ul>
<li class="fragment"><p>Neural networks rebounded around 2010 with big successes in image classification.</p></li>
<li class="fragment"><p>Around that time, massive databases of labeled images were being accumulated, with ever-increasing numbers of classes.</p></li>
</ul>
</section>
<section id="the-cifar100-database" class="slide level2 center">
<h2>The CIFAR100 Database</h2>

<img data-src="figs/cifar100.png" class="quarto-figure quarto-figure-center r-stretch" style="width:85.0%"><div style="font-size: 80%;">
<ul>
<li class="fragment"><p>The figure shows 75 images drawn from the <a href="https://www.cs.toronto.edu/~kriz/cifar.html" target="_blank"><strong>CIFAR100</strong> database</a>.</p></li>
<li class="fragment"><p>This database consists of 60,000 images labeled according to 20 superclasses (e.g.&nbsp;<em>aquatic mammals</em>), with five classes per superclass (<em>beaver, dolphin, otter, seal, whale</em>).</p></li>
<li class="fragment"><p>Each image has a resolution of 32 × 32 pixels, with three eight-bit numbers per pixel representing red, green, and blue. The numbers for each image are organized in a three-dimensional array called a <strong>feature map</strong>.</p></li>
<li class="fragment"><p>The first two axes are spatial (both 32-dimensional), and the third is the <strong>channel</strong> axis, representing the three (blue, green or red) colors.</p></li>
<li class="fragment"><p>There is a designated training set of 50,000 images, and a test set of 10,000.</p></li>
</ul>
</div>
</section>
<section id="the-convolutional-network-hierarchy" class="slide level2 center">
<h2>The Convolutional Network Hierarchy</h2>

<img data-src="figs/10_1_2-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"><div style="font-size: 80%;">
<ul>
<li class="fragment"><p>CNNs mimic, to some degree, how humans classify images, by recognizing specific features or patterns anywhere in the image that distinguish each particular object class.</p></li>
<li class="fragment"><p>The network first identifies <strong>low-level features</strong> in the input image, such as small edges or patches of color.</p></li>
<li class="fragment"><p>These low-level features are then combined to form <strong>higher-level features</strong>, such as parts of ears or eyes. Eventually, the presence or absence of these higher-level features contributes to the probability of any given output class.</p></li>
<li class="fragment"><p>This hierarchical construction is achieved by combining two specialized types of hidden layers: <strong>convolution layers</strong> and <strong>pooling layers</strong>:</p></li>
<li class="fragment"><p><strong>Convolution layers</strong> search for instances of small patterns in the image.</p></li>
<li class="fragment"><p><strong>Pooling layers</strong> downsample these results to select a prominent subset.</p></li>
<li class="fragment"><p>To achieve state-of-the-art results, contemporary neural network architectures often use many convolution and pooling layers.</p></li>
</ul>
</div>
</section>
<section id="convolution-layer" class="slide level2 center">
<h2>Convolution Layer</h2>
<div style="font-size: 70%;">
<ul>
<li class="fragment"><p>A convolution layer is made up of a large number of <strong>convolution filters</strong>, each of which is a template that determines whether a particular local feature is present in an image.</p></li>
<li class="fragment"><p>A <strong>convolution filter</strong> relies on a very simple operation, called a convolution, which basically amounts to repeatedly multiplying matrix elements and then adding the results. <span class="math display">\[
\text{Input Image} =
\begin{bmatrix}
a &amp; b &amp; c \\
d &amp; e &amp; f \\
g &amp; h &amp; i \\
j &amp; k &amp; l
\end{bmatrix}
\quad \text{Convolution Filter} =
\begin{bmatrix}
\alpha &amp; \beta \\
\gamma &amp; \delta
\end{bmatrix}.
\]</span></p></li>
<li class="fragment"><p>When we convolve the image with the filter, we get the result: <span class="math display">\[
\text{Convolved Image} =
\begin{bmatrix}
a\alpha + b\beta + d\gamma + e\delta &amp; b\alpha + c\beta + e\gamma + f\delta \\
d\alpha + e\beta + g\gamma + h\delta &amp; e\alpha + f\beta + h\gamma + i\delta \\
g\alpha + h\beta + j\gamma + k\delta &amp; h\alpha + i\beta + k\gamma + l\delta
\end{bmatrix}.
\]</span></p></li>
<li class="fragment"><p>the convolution filter is applied to every 2 × 2 submatrix of the original image in order to obtain the convolved image.</p></li>
<li class="fragment"><p>If a 2 × 2 submatrix of the original image resembles the convolution filter, then it will have a large value in the convolved image; otherwise, it will have a small value. Thus, the convolved image highlights regions of the original image that resemble the convolution filter.</p></li>
<li class="fragment"><p>The filter is itself an image and represents a small shape, edge, etc.</p></li>
<li class="fragment"><p>The filters are <strong>learned</strong> during training.</p></li>
</ul>
</div>
</section>
<section id="convolution-example" class="slide level2 center">
<h2>Convolution Example</h2>
<div class="columns">
<div class="column" style="justify-content: center; align-items: center;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/10_7-1.png" class="quarto-figure quarto-figure-center" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="justify-content: center; align-items: center;">
<div style="font-size: 80%;">
<ul>
<li class="fragment"><p>The idea of convolution with a filter is to find common patterns that occur in different parts of the image.</p></li>
<li class="fragment"><p>The two filters shown here highlight vertical and horizontal stripes.</p></li>
<li class="fragment"><p>The result of the convolution is a new feature map.</p></li>
<li class="fragment"><p>Since images have three color channels, the filter does as well: one filter per channel, and dot-products are summed.</p></li>
<li class="fragment"><p>The weights in the filters are <strong>learned</strong> by the network.</p></li>
</ul>
</div>
</div></div>
</section>
<section id="pooling-layer" class="slide level2 center">
<h2>Pooling Layer</h2>
<p>A pooling layer provides a way to condense a large image into a smaller summary image.</p>
<p><span class="math display">\[
\text{Max pool}
\begin{bmatrix}
1 &amp; 2 &amp; 5 &amp; 3 \\
3 &amp; 0 &amp; 1 &amp; 2 \\
2 &amp; 1 &amp; 3 &amp; 4 \\
1 &amp; 1 &amp; 2 &amp; 0
\end{bmatrix}
\rightarrow
\begin{bmatrix}
3 &amp; 5 \\
2 &amp; 4
\end{bmatrix}
\]</span></p>
<ul>
<li class="fragment"><p>Each non-overlapping <span class="math inline">\(2 \times 2\)</span> block is replaced by its maximum.</p></li>
<li class="fragment"><p>This sharpens the feature identification.</p></li>
<li class="fragment"><p>Allows for locational invariance.</p></li>
<li class="fragment"><p>Reduces the dimension by a factor of 4 — i.e., factor of 2 in each dimension.</p></li>
</ul>
</section>
<section id="architecture-of-a-cnn" class="slide level2 center">
<h2>Architecture of a CNN</h2>

<img data-src="figs/10_8-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"><ul>
<li class="fragment"><p>Many convolve + pool layers.</p></li>
<li class="fragment"><p>Filters are typically small, e.g., each channel <span class="math inline">\(3 \times 3\)</span>.</p></li>
<li class="fragment"><p>Each filter creates a new channel in the convolution layer.</p></li>
<li class="fragment"><p>As pooling reduces size, the number of filters/channels is typically increased.</p></li>
<li class="fragment"><p>Number of layers can be very large.<br>
E.g., <strong>resnet50</strong> trained on <strong>imagenet</strong> 1000-class image database has 50 layers!</p></li>
</ul>
</section>
<section id="data-augmentation" class="slide level2 center">
<h2>Data Augmentation</h2>

<img data-src="figs/10_1_6-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"><div style="font-size: 80%;">
<ul>
<li class="fragment"><p>An additional important trick used with image modeling is data augmentation.</p></li>
<li class="fragment"><p>Essentially, each training image is replicated many times, with each replicate randomly distorted in a natural way such that human recognition is unaffected.</p></li>
<li class="fragment"><p>Typical distortions are zoom, horizontal and vertical shift, shear, small rotations, and in this case horizontal flips.</p></li>
<li class="fragment"><p>At face value this is a way of increasing the training set considerably with somewhat different examples, and thus protects against overfitting.</p></li>
<li class="fragment"><p>In fact we can see this as a form of regularization: we build a cloud of images around each original image, all with the same label.</p></li>
</ul>
</div>
</section>
<section id="cnn-example-pretrained-networks-to-classify-images" class="slide level2 center">
<h2>CNN Example: Pretrained Networks to Classify Images</h2>

<img data-src="figs/10_1_3-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:45.0%"><p>Here we use the 50-layer <strong>resnet50</strong> network trained on the 1000-class <strong>imagenet</strong> corpus to classify some photographs.</p>
<div class="fragment">
<center>
<strong>Let’s code!</strong>
</center>
</div>
<p><br></p>
</section></section>
<section>
<section id="document-classification" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Document Classification</h1>

</section>
<section id="document-classification-imdb-movie-reviews" class="slide level2 center">
<h2>Document Classification: IMDB Movie Reviews</h2>
<p>The <a href="https://www.kaggle.com/datasets/lakshmi25npathi/imdb-dataset-of-50k-movie-reviews" target="_blank"><strong>IMDB</strong> corpus</a> consists of user-supplied movie ratings for a large collection of movies. Each has been labeled for <strong>sentiment</strong> as <strong>positive</strong> or <strong>negative</strong>. Here is the beginning of a negative review:</p>
<blockquote>
<p><em>This has to be one of the worst films of the 1990s. When my friends &amp; I were watching this film (being the target audience it was aimed at) we just sat &amp; watched the first half an hour with our jaws touching the floor at how bad it really was. The rest of the time, everyone else in the theater just started talking to each other, leaving or generally crying into their popcorn …</em></p>
</blockquote>
<p>We have labeled training and test sets, each consisting of 25,000 reviews, and each balanced with regard to sentiment.</p>
<p><strong>Goal:</strong> We want to build a classifier to predict the sentiment of a review.</p>
</section>
<section id="featurization-bag-of-words" class="slide level2 center">
<h2>Featurization: Bag-of-Words</h2>
<p>Documents have different lengths and consist of sequences of words. How do we create features <span class="math inline">\(X\)</span> to characterize a document?</p>
<ul>
<li class="fragment"><p>From a dictionary, identify the 10K most frequently occurring words.</p></li>
<li class="fragment"><p>Create a binary vector of length <span class="math inline">\(p = 10K\)</span> for each document, and score a 1 in every position that the corresponding word occurred.</p></li>
<li class="fragment"><p>With <span class="math inline">\(n\)</span> documents, we now have an <span class="math inline">\(n \times p\)</span> <strong>sparse</strong> feature matrix <span class="math inline">\(\mathbf{X}\)</span>.</p></li>
<li class="fragment"><p>We compare a lasso logistic regression model to a two-hidden-layer neural network on the next slide. (No convolutions here!)</p></li>
<li class="fragment"><p>Bag-of-words are <strong>unigrams</strong>. We can instead use <strong>bigrams</strong> (occurrences of adjacent word pairs) and, in general, <strong>m-grams</strong>.</p></li>
</ul>
</section>
<section id="document-classification-example-lasso-versus-neural-network-imdb-reviews" class="slide level2 center">
<h2>Document Classification Example: Lasso versus Neural Network — IMDB Reviews</h2>

<img data-src="figs/10_11-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:40.0%"><div style="font-size: 85%;">
<ul>
<li class="fragment">Simpler lasso logistic regression model works as well as neural network in this case.</li>
</ul>
<div class="fragment">
<center>
<strong>Let’s code!</strong>
</center>
</div>
</div>
<p><br></p>
</section></section>
<section>
<section id="recurrent-neural-networks---rnn" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Recurrent Neural Networks - RNN</h1>

</section>
<section id="recurrent-neural-networks---rnn-1" class="slide level2 center">
<h2>Recurrent Neural Networks - RNN</h2>
<ul>
<li class="fragment"><p>Often data arise as sequences:</p>
<ul>
<li class="fragment"><p><strong>Documents</strong> are sequences of words, and their relative positions have meaning.</p></li>
<li class="fragment"><p><strong>Time-series</strong> such as weather data or financial indices.</p></li>
<li class="fragment"><p><strong>Recorded speech or music.</strong></p></li>
</ul></li>
<li class="fragment"><p>RNNs build models that take into account this sequential nature of the data and build a memory of the past.</p>
<ul>
<li class="fragment"><p>The feature for each observation is a <strong>sequence</strong> of vectors <span class="math inline">\(X = \{X_1, X_2, \ldots, X_L\}\)</span>.</p></li>
<li class="fragment"><p>The target <span class="math inline">\(Y\)</span> is often of the usual kind — e.g., a single variable such as <strong>Sentiment</strong>, or a one-hot vector for multiclass.</p></li>
<li class="fragment"><p>However, <span class="math inline">\(Y\)</span> can also be a sequence, such as the same document in a different language.</p></li>
</ul></li>
</ul>
</section>
<section id="simple-recurrent-neural-network-architecture" class="slide level2 center">
<h2>Simple Recurrent Neural Network Architecture</h2>

<img data-src="figs/10_12-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"><ul>
<li class="fragment"><p>The hidden layer is a sequence of vectors <span class="math inline">\(A_\ell\)</span>, receiving as input <span class="math inline">\(X_\ell\)</span> as well as <span class="math inline">\(A_{\ell-1}\)</span>. <span class="math inline">\(A_\ell\)</span> produces an output <span class="math inline">\(O_\ell\)</span>.</p></li>
<li class="fragment"><p>The <strong>same</strong> weights <span class="math inline">\(\mathbf{W}\)</span>, <span class="math inline">\(\mathbf{U}\)</span>, and <span class="math inline">\(\mathbf{B}\)</span> are used at each step in the sequence — hence the term <strong>recurrent</strong>.</p></li>
<li class="fragment"><p>The <span class="math inline">\(A_\ell\)</span> sequence represents an evolving model for the response that is updated as each element <span class="math inline">\(X_\ell\)</span> is processed.</p></li>
</ul>
<p><br></p>
</section>
<section id="rnn-in-detail" class="slide level2 center">
<h2>RNN in Detail</h2>
<div style="font-size: 70%;">
<p>Suppose <span class="math inline">\(X_\ell = (X_{\ell1}, X_{\ell2}, \ldots, X_{\ell p})\)</span> has <span class="math inline">\(p\)</span> components, and <span class="math inline">\(A_\ell = (A_{\ell1}, A_{\ell2}, \ldots, A_{\ell K})\)</span> has <span class="math inline">\(K\)</span> components. Then the computation at the <span class="math inline">\(k\)</span>-th components of hidden unit <span class="math inline">\(A_\ell\)</span> is:</p>
<p><span class="math display">\[
A_{\ell k} = g\left(w_{k0} + \sum_{j=1}^{p} w_{kj} X_{\ell j} + \sum_{s=1}^{K} u_{ks} A_{\ell-1,s}\right)
\]</span></p>
<p><span class="math display">\[
O_\ell = \beta_0 + \sum_{k=1}^{K} \beta_k A_{\ell k}
\]</span></p>
<p>Often we are concerned only with the prediction <span class="math inline">\(O_L\)</span> at the last unit. For squared error loss, and <span class="math inline">\(n\)</span> sequence/response pairs, we would minimize:</p>
<p><span class="math display">\[
\sum_{i=1}^{n} (y_i - o_{iL})^2 = \sum_{i=1}^{n} \left(y_i - \left(\beta_0 + \sum_{k=1}^{K} \beta_k g\left(w_{k0} + \sum_{j=1}^{p} w_{kj} x_{iL,j} + \sum_{s=1}^{K} u_{ks} a_{i,L-1,s}\right)\right)\right)^2
\]</span></p>
</div>
</section></section>
<section>
<section id="rnn-for-document-classification" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>RNN for Document Classification</h1>

</section>
<section id="rnn-for-document-classification-1" class="slide level2 center">
<h2>RNN for Document Classification</h2>
<ul>
<li class="fragment"><p>The document feature is a sequence of words <span class="math inline">\(\{\mathcal{W}_\ell\}_{1}^{L}\)</span>. We typically truncate/pad the documents to the same number <span class="math inline">\(L\)</span> of words (we use <span class="math inline">\(L = 500\)</span>).</p></li>
<li class="fragment"><p>Each word <span class="math inline">\(\mathcal{W}_\ell\)</span> is represented as a <strong>one-hot encoded</strong> binary vector <span class="math inline">\(X_\ell\)</span> (dummy variable) of length <span class="math inline">\(10K\)</span>, with all zeros and a single one in the position for that word in the dictionary.</p></li>
<li class="fragment"><p>This results in an extremely sparse feature representation and would not work well.</p></li>
<li class="fragment"><p>Instead, we use a lower-dimensional pretrained <strong>word embedding</strong> matrix <span class="math inline">\(\mathbf{E}\)</span> (<span class="math inline">\(m \times 10K\)</span>, next slide).</p></li>
<li class="fragment"><p>This reduces the binary feature vector of length <span class="math inline">\(10K\)</span> to a real feature vector of dimension <span class="math inline">\(m \ll 10K\)</span> (e.g., <span class="math inline">\(m\)</span> in the low hundreds).</p></li>
</ul>
</section>
<section id="word-embedding---rnn-example-imdb-reviews" class="slide level2 center">
<h2>Word Embedding - RNN Example: <a href="https://paperswithcode.com/sota/%20sentiment-analysis-on-imdb" target="_blank">IMDB Reviews</a></h2>
<div style="font-size: 65%;">
<p>Review:</p>
<blockquote>
<p>this is one of the best films actually the best I have ever seen the film starts one fall day…</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/10_13a-1.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/10_13b-1.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</div>
</div>
<p>Embeddings are pretrained on very large corpora of documents, using methods similar to principal components. <a href="https://code.google.com/archive/p/word2vec" target="_blank"><strong>word2vec</strong></a> and <a href="https://nlp.stanford.edu/projects/glove" target="_blank"><strong>GloVe</strong></a> are popular.</p>
</div>
<div class="fragment">
<center>
<strong>Let’s code!</strong>
</center>
</div>
<p><br></p>
<!---

XXXXXXXXXXXXXX

-   After a lot of work, the results are a disappointing 76% accuracy.

-   We then fit a more exotic RNN than the one displayed — a **LSTM** with *long and short term memory*. Here $A_\ell$ receives input from $A_{\ell-1}$ (short term memory) as well as from a version that reaches further back in time (long term memory). Now we get 87% accuracy, slightly less than the 88% achieved by **glmnet**.

-   These data have been used as a benchmark for new RNN architectures. The best reported result found at the time of writing (2020) was around 95%. We point to a **leaderboard** in Section 10.5.1.

XXXXXXXXXXXXXX
--->
</section></section>
<section>
<section id="rnn-for-time-series-forecasting" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>RNN for Time Series Forecasting</h1>

</section>
<section id="rnn-time-series-forecasting" class="slide level2 center">
<h2>RNN: Time Series Forecasting</h2>
<div style="font-size: 70%;">
<div class="columns">
<div class="column" style="justify-content: center; align-items: center;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/10_14-1.png" class="quarto-figure quarto-figure-center" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="justify-content: center; align-items: center;">
<p><strong>New-York Stock Exchange Data</strong></p>
<p>Three daily time series for the period December 3, 1962, to December 31, 1986 (6,051 trading days):</p>
<ul>
<li class="fragment"><p><strong>Log trading volume.</strong> This is the fraction of all outstanding shares that are traded on that day, relative to a 100-day moving average of past turnover, on the log scale.</p></li>
<li class="fragment"><p><strong>Dow Jones return.</strong> This is the difference between the log of the Dow Jones Industrial Index on consecutive trading days.</p></li>
<li class="fragment"><p><strong>Log volatility.</strong> This is based on the absolute values of daily price movements.</p></li>
</ul>
<div class="fragment">
<p><strong>Goal</strong>: predict <strong>Log trading volume</strong> tomorrow, given its observed values up to today, as well as those of <strong>Dow Jones return</strong> and <strong>Log volatility</strong>.</p>
<p><em>These data were assembled by LeBaron and Weigend (1998) IEEE Transactions on Neural Networks, 9(1): 213–220.</em></p>
</div>
</div></div>
</div>
</section>
<section id="autocorrelation" class="slide level2 center">
<h2>Autocorrelation</h2>

<img data-src="figs/10_15-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"><ul>
<li class="fragment"><p>The <strong>autocorrelation</strong> at lag <span class="math inline">\(\ell\)</span> is the correlation of all pairs <span class="math inline">\((v_t, v_{t-\ell})\)</span> that are <span class="math inline">\(\ell\)</span> trading days apart.</p></li>
<li class="fragment"><p>These sizable correlations give us confidence that past values will be helpful in predicting the future.</p></li>
<li class="fragment"><p>This is a curious prediction problem: the response <span class="math inline">\(v_t\)</span> is also a feature <span class="math inline">\(v_{t-\ell}\)</span>!</p></li>
</ul>
<p><br></p>
</section>
<section id="rnn-forecaster" class="slide level2 center">
<h2>RNN Forecaster</h2>
<p>We only have one series of data! How do we set up for an RNN?</p>
<p>We extract many short mini-series of input sequences <span class="math inline">\(\mathbf{X} = \{ X_1, X_2, \ldots, X_L \}\)</span> with a predefined length <span class="math inline">\(L\)</span> known as the <strong>lag</strong>:</p>
<p><span class="math display">\[
X_1 = \begin{pmatrix}
v_{t-L} \\
r_{t-L} \\
z_{t-L}
\end{pmatrix}, \quad
X_2 = \begin{pmatrix}
v_{t-L+1} \\
r_{t-L+1} \\
z_{t-L+1}
\end{pmatrix}, \quad
\cdots, \quad
X_L = \begin{pmatrix}
v_{t-1} \\
r_{t-1} \\
z_{t-1}
\end{pmatrix}, \quad \text{and} \quad Y = v_t.
\]</span></p>
<p>Since <span class="math inline">\(T = 6,051\)</span>, with <span class="math inline">\(L = 5\)</span>, we can create 6,046 such <span class="math inline">\((X, Y)\)</span> pairs.</p>
<p>We use the first 4,281 as training data, and the following 1,770 as test data. We fit an RNN with 12 hidden units per lag step (i.e., per <span class="math inline">\(A_\ell\)</span>).</p>
</section>
<section id="rnn-results-for-nyse-data" class="slide level2 center">
<h2>RNN Results for NYSE Data</h2>

<img data-src="figs/10_16-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"><p>The figure shows predictions and truth for the test period.</p>
<p><span class="math display">\[
R^2 = 0.42 \text{ for RNN}
\]</span></p>
<p><span class="math inline">\(R^2 = 0.18\)</span> for the naive approach — uses yesterday’s value of Log trading volume to predict that of today.</p>
<div class="fragment">
<center>
<strong>Let’s code!</strong>
</center>
</div>
<p><br></p>
</section>
<section id="autoregression-forecaster" class="slide level2 center">
<h2>Autoregression Forecaster</h2>
<p>The RNN forecaster is similar in structure to a traditional <strong>autoregression</strong> procedure.</p>
<p><span class="math display">\[
\mathbf{y} =
\begin{bmatrix}
v_{L+1} \\
v_{L+2} \\
v_{L+3} \\
\vdots \\
v_T
\end{bmatrix}, \quad
\mathbf{M} =
\begin{bmatrix}
1 &amp; v_L &amp; v_{L-1} &amp; \cdots &amp; v_1 \\
1 &amp; v_{L+1} &amp; v_L &amp; \cdots &amp; v_2 \\
1 &amp; v_{L+2} &amp; v_{L+1} &amp; \cdots &amp; v_3 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
1 &amp; v_{T-1} &amp; v_{T-2} &amp; \cdots &amp; v_{T-L}
\end{bmatrix}.
\]</span></p>
<p>Fit an OLS regression of <span class="math inline">\(\mathbf{y}\)</span> on <span class="math inline">\(\mathbf{M}\)</span>, giving:</p>
<p><span class="math display">\[
\hat{v}_t = \hat{\beta}_0 + \hat{\beta}_1 v_{t-1} + \hat{\beta}_2 v_{t-2} + \cdots + \hat{\beta}_L v_{t-L}.
\]</span></p>
<p>Known as an <strong>order-</strong><span class="math inline">\(L\)</span> autoregression model or <span class="math inline">\(AR(L)\)</span>.</p>
<p>For the <strong>NYSE</strong> data, we can include lagged versions of <strong>DJ_return</strong> and <strong>log_volatility</strong> in matrix <span class="math inline">\(\mathbf{M}\)</span>, resulting in <span class="math inline">\(3L + 1\)</span> columns.</p>
</section>
<section id="autoregression-results-for-nyse-data" class="slide level2 center">
<h2>Autoregression Results for NYSE Data</h2>
<ul>
<li class="fragment"><p><span class="math inline">\(R^2 = 0.41 \text{ for } AR(5) \text{ model (16 parameters)}\)</span></p></li>
<li class="fragment"><p><span class="math inline">\(R^2 = 0.42 \text{ for RNN model (205 parameters)}\)</span></p></li>
<li class="fragment"><p><span class="math inline">\(R^2 = 0.42 \text{ for } AR(5) \text{ model fit by neural network.}\)</span></p></li>
<li class="fragment"><p><span class="math inline">\(R^2 = 0.46 \text{ for all models if we include } \textbf{day_of_week} \text{ of day being predicted.}\)</span></p></li>
</ul>
</section>
<section id="summary-of-rnns" class="slide level2 center">
<h2>Summary of RNNs</h2>
<ul>
<li class="fragment"><p>We have presented the simplest of RNNs. Many more complex variations exist.</p></li>
<li class="fragment"><p>One variation treats the sequence as a one-dimensional image, and uses CNNs for fitting. For example, a sequence of words using an embedding representation can be viewed as an image, and the CNN convolves by sliding a convolutional filter along the sequence.</p></li>
<li class="fragment"><p>Can have additional hidden layers, where each hidden layer is a sequence, and treats the previous hidden layer as an input sequence.</p></li>
<li class="fragment"><p>Can have output also be a sequence, and input and output share the hidden units. So called <strong>seq2seq</strong> learning are used for language translation.</p></li>
</ul>
</section></section>
<section>
<section id="when-to-use-deep-learning" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>When to Use Deep Learning</h1>

</section>
<section id="when-to-use-deep-learning-1" class="slide level2 center">
<h2>When to Use Deep Learning</h2>
<div style="font-size: 90%;">
<ul>
<li class="fragment"><p><strong>CNNs</strong> have had enormous successes in image classification and modeling, and are starting to be used in medical diagnosis. Examples include digital mammography, ophthalmology, MRI scans, and digital X-rays.</p></li>
<li class="fragment"><p><strong>RNNs</strong> have had big wins in speech modeling, language translation, and forecasting.</p></li>
</ul>
<div class="fragment">
<p>Should we always use deep learning models?</p>
<ul>
<li class="fragment"><p>Often the big successes occur when the <strong>signal to noise ratio</strong> is high — e.g., image recognition and language translation. Datasets are large, and overfitting is not a big problem.</p></li>
<li class="fragment"><p>For noisier data, simpler models can often work better:</p>
<ul>
<li class="fragment"><p>On the <strong>NYSE</strong> data, the <strong>AR(5)</strong> model is much simpler than an RNN, and performed as well.</p></li>
<li class="fragment"><p>On the <strong>IMDB</strong> review data, a linear model fit (e.g.&nbsp;with glmnet) did as well as the neural network, and better than the RNN.</p></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="flexibility-vs.-interpretability" class="slide level2 center">
<h2>Flexibility vs.&nbsp;Interpretability</h2>
<div style="font-size: 80%;">
<p>Trade-offs between <strong>flexibility</strong> and <strong>interpretability</strong>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/2_7-1.png" class="quarto-figure quarto-figure-center" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<p>As the authors suggest, I also endorse the <a href="https://en.wikipedia.org/wiki/Occam%27s_razor" target="_blank"><strong>Occam’s razor</strong> principle</a> — we prefer simpler models if they work as well. More interpretable!</p>
<p><br></p>
</div>
</section></section>
<section>
<section id="special-topic-large-language-models-llm" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Special Topic: Large Language Models (LLM)</h1>

</section>
<section id="special-topic-large-language-models-llm-1" class="slide level2 center">
<h2>Special Topic: Large Language Models (LLM)</h2>
<p><br></p>
<center>
<iframe width="800" height="450" src="https://www.youtube.com/embed/watch?v=LPZh9BOjkQs&amp;list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&amp;index=5" title="Large Language Models explained briefly" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
</center>
<center>
<a href="https://www.youtube.com/watch?v=LPZh9BOjkQs&amp;list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&amp;index=5" target="_blank">Large Language Models explained briefly</a>
</center>
</section>
<section id="special-topic-llm---transformers" class="slide level2 center">
<h2>Special Topic: LLM - Transformers</h2>
<p><br></p>
<center>
<iframe width="800" height="450" src="https://www.youtube.com/embed/watch?v=wjZofJX0v4M&amp;list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&amp;index=6" title="Transformers, the tech behind LLMs" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
</center>
<center>
<a href="https://www.youtube.com/watch?v=wjZofJX0v4M&amp;list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&amp;index=6" target="_blank">Transformers, the tech behind LLMs</a>
</center>
</section>
<section id="special-topic-llm---attention" class="slide level2 center">
<h2>Special Topic: LLM - Attention</h2>
<p><br></p>
<center>
<iframe width="800" height="450" src="https://www.youtube.com/embed/watch?v=eMlx5fFNoYc&amp;list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&amp;index=7" title="Attention in transformers, step-by-step" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
</center>
<center>
<a href="https://www.youtube.com/watch?v=eMlx5fFNoYc&amp;list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&amp;index=7" target="_blank">Attention in transformers, step-by-step</a>
</center>
</section>
<section id="special-topic-llm---memory" class="slide level2 center">
<h2>Special Topic: LLM - Memory</h2>
<p><br></p>
<center>
<iframe width="800" height="450" src="https://www.youtube.com/embed/watch?v=9-Jl0dxWQs8&amp;list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&amp;index=8" title="How might LLMs store facts" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
</center>
<center>
<a href="https://www.youtube.com/watch?v=9-Jl0dxWQs8&amp;list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&amp;index=8" target="_blank">How might LLMs store facts</a>
</center>
</section>
<section id="additional-material" class="slide level2 center">
<h2>Additional Material</h2>
<ul>
<li class="fragment"><a href="https://www.youtube.com/watch?v=aircAruvnKk&amp;list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi" target="_blank">3Blue1Brown: Neural Networks</a></li>
<li class="fragment"><a href="https://www.deeplearningbook.org/" target="_blank">Deep Learning, by Ian Goodfellow and Yoshua Bengio and Aaron Courvill</a></li>
<li class="fragment"><a href="https://www.youtube.com/watch?v=bxe2T-V8XRs&amp;list=PLiaHhY2iBX9hdHaRr6b7XevZtgZRa1PoU" target="_blank">Welch Labs: Neural Networks Demystified</a></li>
<li class="fragment"><a href="https://www.youtube.com/watch?v=i8D90DkCLhI&amp;list=PLiaHhY2iBX9ihLasvE8BKnS2Xg8AhY6iV" target="_blank">Welch Labs: Learning To See</a></li>
<li class="fragment"><a href="https://distill.pub/" target="_blank">Distill: A Gentle Introduction to Graph Neural Networks</a></li>
<li class="fragment"><a href="http://neuralnetworksanddeeplearning.com/" target="_blank">Neural Networks and Deep Learning, by Michael Nielsen</a></li>
<li class="fragment"><a href="https://weiliu2k.github.io/CITS4012/nn/intro.html" target="_blank">CITS4012 Natural Language Processing</a></li>
<li class="fragment"><a href="https://github.com/dvgodoy/PyTorchStepByStep/tree/master" target="_blank">Deep Learning with PyTorch Step-by-Step</a></li>
</ul>
</section>
<section id="summary" class="slide level2 center">
<h2>Summary</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div style="font-size: 80%;">
<ul>
<li><strong>Deep Learning Renaissance</strong>
<ul>
<li>Neural networks first rose to prominence in the 1980s, waned in the 1990s, then surged again around 2010.</li>
<li>Advances in computing (GPUs) and availability of massive labeled datasets propelled deep learning success.</li>
</ul></li>
<li><strong>Frameworks (PyTorch vs.&nbsp;TensorFlow)</strong>
<ul>
<li>PyTorch is known for its dynamic graph and Pythonic syntax; widely used in research.</li>
<li>TensorFlow has an extensive production ecosystem, ideal for enterprise and deployment.</li>
</ul></li>
<li><strong>Essential Concepts</strong>
<ul>
<li>Automatic differentiation, gradient descent, and backpropagation are at the core of training neural networks.</li>
</ul></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div style="font-size: 80%;">
<ul>
<li><strong>CNNs and RNNs</strong>
<ul>
<li><strong>CNNs</strong> excel in image classification by learning local patterns via convolution and pooling layers.<br>
</li>
<li><strong>RNNs</strong> (and variants like LSTM, GRU) handle sequential data for tasks like language modeling and time-series forecasting.</li>
</ul></li>
<li><strong>When to Use Deep Learning</strong>
<ul>
<li>Works best on large datasets with high signal-to-noise ratio (e.g., image, text).<br>
</li>
<li>Simpler models often perform well on noisier tasks or smaller datasets.<br>
</li>
<li>Over-parameterization can still generalize due to “double-descent” effects.</li>
</ul></li>
<li><strong>Practical Tips</strong>
<ul>
<li>Use regularization (dropout, data augmentation, weight decay) to mitigate overfitting.<br>
</li>
<li>Monitor convergence with appropriate learning rates and consider mini-batch stochastic gradient descent.</li>
</ul></li>
</ul>
</div>
</div></div>
</section></section>
<section id="thank-you" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Thank you!</h1>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>Predictive Analytics</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>